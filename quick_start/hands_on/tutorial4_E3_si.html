<!doctypehtml><html data-content_root=../../ lang=en><head><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0 name=viewport><meta content=width=device-width,initial-scale=1 name=viewport><title>Tutorial 4: Training deeptb-e3 model for Silicon — DeePTB  documentation</title><script data-cfasync=false>document.documentElement.dataset.mode=localStorage.getItem(`mode`)||``;document.documentElement.dataset.theme=localStorage.getItem(`theme`)||``</script><link href=../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b rel=stylesheet><link href=../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b rel=stylesheet><link href=../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b rel=stylesheet><link href=../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b rel=stylesheet><link as=font crossorigin href=../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2 rel=preload type=font/woff2><link as=font crossorigin href=../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2 rel=preload type=font/woff2><link as=font crossorigin href=../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2 rel=preload type=font/woff2><link href=../../_static/pygments.css?v=8f2a1f02 rel=stylesheet><link href=../../_static/styles/sphinx-book-theme.css?v=eba8b062 rel=stylesheet><link href=../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css rel=stylesheet><link href=../../_static/banner.css?v=f1520836 rel=stylesheet><link as=script href=../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b rel=preload><link as=script href=../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b rel=preload><script src=../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b></script><script src=../../_static/documentation_options.js?v=9eb32ce0></script><script src=../../_static/doctools.js?v=9bcbadda></script><script src=../../_static/sphinx_highlight.js?v=dc90522c></script><script src=../../_static/scripts/sphinx-book-theme.js?v=887ef09a></script><script>window.MathJax={"options":{"processHtmlClass":`tex2jax_process|mathjax_process|math|output_area`}}</script><script defer src=https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.min.js></script><script src=../../_static/banner.js?v=a6a668d4></script><script>DOCUMENTATION_OPTIONS.pagename=`quick_start/hands_on/tutorial4_E3_si`</script><link href=../../genindex.html rel=index title=Index><link href=../../search.html rel=search title=Search><link title="Basic API"href=../basic_api.html rel=next><link title="Tutorial 3: Training deeptb-sk model for Silicon"href=tutorial3_train_si.html rel=prev><meta content=width=device-width,initial-scale=1 name=viewport><meta content=en name=docsearch:language><link href=https://unpkg.com/ rel=preconnect><link href=https://unpkg.com/@njzjz/icons@0.0.5/logos/deepmodeling.svg rel=icon type=image/png><div class="container-fluid header-holder tutorials-header"id=header-holder><div class=container><div class=header-container><a aria-label=deepmodeling class=header-logo href=https://deepmodeling.com></a><div class=main-menu><ul><li><a href=https://deepmodeling.com>Home</a></li><li><a href=https://blogs.deepmodeling.com>Blog</a></li><li><a href=https://tutorials.deepmodeling.com>Tutorials</a></li><li class="active docs-active"><div class=resources-dropdown data-toggle=resources-dropdown id=resourcesDropdownButton><a class="resource-option with-down-orange-arrow"href=https://docs.deepmodeling.com/> Docs </a><div class=resources-dropdown-menu><a class="doc-dropdown-option nav-dropdown-item"href=https://docs.deepmodeling.com/projects/deepmd/> <span class=dropdown-title>DeePMD-kit</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://docs.deepmodeling.com/projects/dpgen/> <span class=dropdown-title>DP-GEN</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://docs.deepmodeling.com/projects/dpdata/> <span class=dropdown-title>dpdata</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://docs.deepmodeling.com/projects/dpdispatcher/> <span class=dropdown-title>DPDispatcher</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://abacus.deepmodeling.com/> <span class=dropdown-title>ABACUS</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://deepflame.deepmodeling.com/> <span class=dropdown-title>DeepFlame</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://docs.deepmodeling.com/projects/dpti/> <span class=dropdown-title>DPTI</span> <p></p> </a></div></div></li><li><a href=https://blogs.deepmodeling.com/papers/>Publications</a></li><li><a href=https://github.com/deepmodeling>GitHub</a></li></ul></div><a class=main-menu-open-button data-behavior=open-mobile-menu href=#></a></div></div></div><div class=mobile-main-menu><div class=container-fluid><div class=container><div class=mobile-main-menu-header-container><a aria-label=deepmodeling class=header-logo href=https://deepmodeling.com></a><a class=main-menu-close-button data-behavior=close-mobile-menu href=#></a></div></div></div><div class=mobile-main-menu-links-container><div class=main-menu><ul><li><a href=https://deepmodeling.com>Home</a></li><li><a href=https://blogs.deepmodeling.com>Blog</a></li><li><a href=https://tutorials.deepmodeling.com>Tutorials</a></li><li><a href=https://docs.deepmodeling.com/>Docs</a></li><li><a href=https://blogs.deepmodeling.com/papers/>Publications</a></li><li><a href=https://github.com/deepmodeling>GitHub</a></li></ul></div></div></div></head><body data-bs-root-margin="0px 0px -60%"data-bs-spy=scroll data-bs-target=.bd-toc-nav data-default-mode data-offset=180><div class="skip-link d-print-none"id=pst-skip-link><a href=#main-content>Skip to main content</a></div><div id=pst-scroll-pixel-helper></div><button class="btn rounded-pill"id=pst-back-to-top type=button><i class="fa-solid fa-arrow-up"></i>Back to top</button><input class=sidebar-toggle id=pst-primary-sidebar-checkbox type=checkbox><label class="overlay overlay-primary"for=pst-primary-sidebar-checkbox></label><input class=sidebar-toggle id=pst-secondary-sidebar-checkbox type=checkbox><label class="overlay overlay-secondary"for=pst-secondary-sidebar-checkbox></label><div class=search-button__wrapper><div class=search-button__overlay></div><div class=search-button__search-container><form class="bd-search d-flex align-items-center"action=../../search.html><i class="fa-solid fa-magnifying-glass"></i><input aria-label=Search... autocapitalize=off autocomplete=off autocorrect=off class=form-control id=search-input name=q placeholder=Search... spellcheck=false type=search><span class=search-button__kbd-shortcut><kbd class=kbd-shortcut__modifier>Ctrl</kbd>+<kbd>K</kbd></span></form></div></div><div class="pst-async-banner-revealer d-none"><aside aria-label="Version warning"class="d-none d-print-none"id=bd-header-version-warning></aside></div><header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none"></header><div class=bd-container><div class="bd-container__inner bd-page-width"><div class="bd-sidebar-primary bd-sidebar"><div class="sidebar-header-items sidebar-primary__section"></div><div class="sidebar-primary-items__start sidebar-primary__section"><div class=sidebar-primary-item><a class="navbar-brand logo"href=../../index.html> <img alt="DeePTB  documentation - Home"class="logo__image only-light"src=../../_static/deeptb-logo.svg> <script>document.write(`<img src="../../_static/deeptb-logo.svg" class="logo__image only-dark" alt="DeePTB  documentation - Home"/>`)</script> </a></div><div class=sidebar-primary-item><script>document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `)</script></div><div class=sidebar-primary-item><nav class="bd-links bd-docs-nav"aria-label=Main><div class="bd-toc-item navbar-nav active"><p aria-level=2 class=caption role=heading><span class=caption-text>Quick Start</span></p><ul class="current nav bd-sidenav"><li class=toctree-l1><a class="reference internal"href=../easy_install.html>Installation Guide</a></li><li class=toctree-l1><a class="reference internal"href=../input.html>Brief Intro. to Inputs and Commands</a></li><li class="toctree-l1 current active has-children"><a class="reference internal"href=index.html>A quick Example</a><details open><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul class=current><li class=toctree-l2><a class="reference internal"href=tutorial1_base_sk.html>Tutorial 1: deeptb-sk baseline model</a></li><li class=toctree-l2><a class="reference internal"href=tutorial2_data.html>Tutorial 2: data preparation for deeptb-sk model</a></li><li class=toctree-l2><a class="reference internal"href=tutorial3_train_si.html>Tutorial 3: Training deeptb-sk model for Silicon</a></li><li class="toctree-l2 current active"><a class="current reference internal"href=#>Tutorial 4: Training deeptb-e3 model for Silicon</a></li></ul></details></li><li class=toctree-l1><a class="reference internal"href=../basic_api.html>Basic API</a></li></ul><p aria-level=2 class=caption role=heading><span class=caption-text>INPUT TAG</span></p><ul class="nav bd-sidenav"><li class="toctree-l1 has-children"><a class="reference internal"href=../../input_params/index.html>Full Input Parameters</a><details><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul><li class=toctree-l2><a class="reference internal"href=../../input_params/common_options.html>Common Options</a></li><li class=toctree-l2><a class="reference internal"href=../../input_params/train_options.html>Train Options</a></li><li class=toctree-l2><a class="reference internal"href=../../input_params/model_options.html>Model Options</a></li><li class=toctree-l2><a class="reference internal"href=../../input_params/data_options.html>Data Options</a></li><li class=toctree-l2><a class="reference internal"href=../../input_params/run_options.html>Run Options</a></li><li class=toctree-l2><a class="reference internal"href=../../input_params/set_info.html>Set Info</a></li></ul></details></li></ul><p aria-level=2 class=caption role=heading><span class=caption-text>Advanced</span></p><ul class="nav bd-sidenav"><li class="toctree-l1 has-children"><a class="reference internal"href=../../advanced/sktb/index.html>DeePTB-SK Advanced</a><details><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul><li class=toctree-l2><a class="reference internal"href=../../advanced/sktb/dftb.html>DFTB SK Files to DeePTB Model</a></li><li class=toctree-l2><a class="reference internal"href=../../advanced/sktb/dptb_env.html>Environment-dependent TB</a></li><li class=toctree-l2><a class="reference internal"href=../../advanced/sktb/nrl_tb.html>NRL-TB paramererization</a></li><li class=toctree-l2><a class="reference internal"href=../../advanced/sktb/soc.html>Spin-orbit coupling</a></li></ul></details></li><li class="toctree-l1 has-children"><a class="reference internal"href=../../advanced/e3tb/index.html>DeePTB-E3 Advanced</a><details><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul><li class=toctree-l2><a class="reference internal"href=../../advanced/e3tb/advanced_input.html>More on Input Parameters</a></li><li class=toctree-l2><a class="reference internal"href=../../advanced/e3tb/data_preparation.html>Data Preparation</a></li><li class=toctree-l2><a class="reference internal"href=../../advanced/e3tb/loss_analysis.html>Loss Analysis</a></li></ul></details></li><li class="toctree-l1 has-children"><a class="reference internal"href=../../advanced/elec_properties/index.html>Electronic Properties and Outputs</a><details><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul><li class=toctree-l2><a class="reference internal"href=../../advanced/elec_properties/band.html>Band structure</a></li></ul></details></li><li class="toctree-l1 has-children"><a class="reference internal"href=../../advanced/interface/index.html>Interfaces to Other Softwares</a><details><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul><li class=toctree-l2><a class="reference internal"href=../../advanced/interface/TBPLAS.html>TBPLAS</a></li><li class=toctree-l2><a class="reference internal"href=../../advanced/interface/TBtrans.html>TBtrans</a></li></ul></details></li></ul><p aria-level=2 class=caption role=heading><span class=caption-text>Citing DeePTB</span></p><ul class="nav bd-sidenav"><li class=toctree-l1><a class="reference internal"href=../../CITATIONS.html>How to Cite</a></li></ul><p aria-level=2 class=caption role=heading><span class=caption-text>Developing Team</span></p><ul class="nav bd-sidenav"><li class=toctree-l1><a class="reference internal"href=../../DevelopingTeam.html>Development Team</a></li></ul><p aria-level=2 class=caption role=heading><span class=caption-text>Community</span></p><ul class="nav bd-sidenav"><li class=toctree-l1><a class="reference internal"href=../../community/contribution_guide.html>DeePTB Contribution Guide</a></li><li class=toctree-l1><a class="reference internal"href=../../CONTRIBUTING.html>Contributing to DeePTB</a></li></ul></div></nav></div></div><div class="sidebar-primary-items__end sidebar-primary__section"></div><div id=rtd-footer-container></div></div><main class=bd-main id=main-content role=main><div class=sbt-scroll-pixel-helper></div><div class=bd-content><div class=bd-article-container><div class="bd-header-article d-print-none"><div class="header-article-items header-article__inner"><div class=header-article-items__start><div class=header-article-item><button class="sidebar-toggle primary-toggle btn btn-sm"title="Toggle primary sidebar"data-bs-placement=bottom data-bs-toggle=tooltip><span class="fa-solid fa-bars"></span></button></div></div><div class=header-article-items__end><div class=header-article-item><div class=article-header-buttons><div class="dropdown dropdown-download-buttons"><button aria-label="Download this page"class="btn dropdown-toggle"aria-expanded=false data-bs-toggle=dropdown type=button><i class="fas fa-download"></i></button><ul class=dropdown-menu><li><a class="btn btn-sm btn-download-source-button dropdown-item"title="Download source file"data-bs-placement=left data-bs-toggle=tooltip href=../../_sources/quick_start/hands_on/tutorial4_E3_si.ipynb target=_blank> <span class=btn__icon-container> <i class="fas fa-file"></i> </span> <span class=btn__text-container>.ipynb</span> </a></li><li><button class="btn btn-sm btn-download-pdf-button dropdown-item"title="Print to PDF"data-bs-placement=left data-bs-toggle=tooltip onclick=window.print()><span class=btn__icon-container> <i class="fas fa-file-pdf"></i> </span> <span class=btn__text-container>.pdf</span></button></li></ul></div><button class="btn btn-sm btn-fullscreen-button"title="Fullscreen mode"data-bs-placement=bottom data-bs-toggle=tooltip onclick=toggleFullScreen()><span class=btn__icon-container> <i class="fas fa-expand"></i> </span></button><script>document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`)</script><script>document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`)</script><button class="sidebar-toggle secondary-toggle btn btn-sm"title="Toggle secondary sidebar"data-bs-placement=bottom data-bs-toggle=tooltip><span class="fa-solid fa-list"></span></button></div></div></div></div></div><div class=onlyprint id=jb-print-docs-body><h1>Tutorial 4: Training deeptb-e3 model for Silicon</h1><div id=print-main-content><div id=jb-print-toc><div><h2>Contents</h2></div><nav aria-label=Page><ul class="visible nav section-nav flex-column"><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#introduction>Introduction</a><ul class="nav section-nav flex-column"><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#version-features>Version Features</a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#learning-objectives>Learning Objectives</a></li></ul></li><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#content>Content</a></li><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#method>Method: <a id=method></a></a><ul class="nav section-nav flex-column"><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#what-is-deeptb-e3>What is DeePTB-E3: <a id=whatis></a></a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#what-to-do-with-deeptb-e3>What to do with DeePTB-E3 <a id=whattodo></a></a></li></ul></li><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#practice>Practice <a id=practice></a></a><ul class="nav section-nav flex-column"><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#prepare-the-data><strong>1. Prepare the Data</strong> <a id=dataprepare></a></a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#model-training><strong>2. Model Training</strong> <a id=train></a></a></li></ul></li><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#more-method>More Method<a id=moremethod></a></a><ul class="nav section-nav flex-column"><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#parametrization-of-the-equivariant-representation>Parametrization of the Equivariant Representation: <a id=e3representation></a></a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#invariant-representation-of-overlap-integrals>Invariant Representation of Overlap Integrals <a id=overlaprepresentation></a></a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#model-architecture>Model Architecture <a id=modelarchitecture></a></a></li></ul></li></ul></nav></div></div></div><div id=searchbox></div><article class=bd-article><section class="tex2jax_ignore mathjax_ignore"id=tutorial-4-training-deeptb-e3-model-for-silicon><h1>Tutorial 4: Training deeptb-e3 model for Silicon<a title="Link to this heading"class=headerlink href=#tutorial-4-training-deeptb-e3-model-for-silicon>#</a></h1><section id=introduction><h2>Introduction<a title="Link to this heading"class=headerlink href=#introduction>#</a></h2><p><strong>DeePTB</strong> is a method that uses deep learning to accelerate first-principles electronic structure simulations.</p><section id=version-features><h3>Version Features<a title="Link to this heading"class=headerlink href=#version-features>#</a></h3><ul class=simple><li><p><strong>v1</strong>: Constructed tight-binding (TB) models with first-principles accuracy (DeePTB-SK)</p></li><li><p><strong>v2.0-2.1</strong>: Added E3 equivariant networks to represent single-electron operators (Hamiltonian, density matrix, and overlap matrix) (DeePTB-E3)</p></li><li><p><strong>v2.2</strong>: Incorporated built-in SK empirical parameters covering commonly used elements across the periodic table</p></li></ul><p>Through these capabilities, DeePTB provides multiple approaches to accelerate electronic structure simulations of materials.</p></section><section id=learning-objectives><h3>Learning Objectives<a title="Link to this heading"class=headerlink href=#learning-objectives>#</a></h3><ol class="arabic simple"><li><p>Understanding how to setup DeePTB-E3 model to train on equivariant LCAO Kohn-Sham (KS) Hamiltonian.</p></li><li><p>Get a highly accurate DeePTB-E3 model of single crystal silicon.</p></li><li><p>Get familiar with DeePTB’s properties calculation module.</p></li></ol></section></section><section id=content><h2>Content<a title="Link to this heading"class=headerlink href=#content>#</a></h2><ul class=simple><li><p><a class="reference internal"href=#method><span class="xref myst">Method</span></a></p> <ul><li><p><a class="reference internal"href=#whatis><span class="xref myst">1. What is DeePTB-E3</span></a></p></li><li><p><a class="reference internal"href=#whattodo><span class="xref myst">2. What to do with DeePTB-E3</span></a></p></li></ul></li><li><p><a class="reference internal"href=#practice><span class="xref myst">Practice</span></a></p> <ul><li><p><a class="reference internal"href=#dataprepare><span class="xref myst">1. Prepare the data</span></a></p></li><li><p><a class="reference internal"href=#train><span class="xref myst">2. Model Training</span></a></p></li><li><p><a class="reference internal"href=#application><span class="xref myst">3. Properties Calculation</span></a></p></li></ul></li><li><p><a class="reference internal"href=#moremethod><span class="xref myst">More Method</span></a></p> <ul><li><p><a class="reference internal"href=#e3representation><span class="xref myst">Parametrize E3 features</span></a></p></li><li><p><a class="reference internal"href=#overlaprepresentation><span class="xref myst">Invariant Representation of Overlap Matrix</span></a></p></li><li><p><a class="reference internal"href=#modelarchitecture><span class="xref myst">Model Structure</span></a></p></li></ul></li></ul></section><section id=method><h2>Method: <a id=method></a><a title="Link to this heading"class=headerlink href=#method>#</a></h2><p>Here we briefly introduce the method of DeePTB-E3 from its functional and operational perspective. For more theoretical and technical parts, please refer to the <a class="reference internal"href=#moremethod><span class="xref myst"><strong>More Method</strong></span></a> section or our paper: <a class="reference external"href=https://openreview.net/pdf?id=kpq3IIjUD3>SLEM ICLR2025</a>.</p><section id=what-is-deeptb-e3><h3>What is DeePTB-E3: <a id=whatis></a><a title="Link to this heading"class=headerlink href=#what-is-deeptb-e3>#</a></h3><p><strong>DeePTB-E3</strong> is a flexible function in DeePTB package supporting training a neural network model to predict directly the LCAO Quantum Operators, including Hamiltonian, Density Matrix and Overlap Matrix of Kohn-Sham DFT. The training data are generated directly via LCAO DFT packages. We employ a strictly local equivariant model, that preserves the physics, which enables efficient learning and a reduced amount of data required.</p></section><section id=what-to-do-with-deeptb-e3><h3>What to do with DeePTB-E3 <a id=whattodo></a><a title="Link to this heading"class=headerlink href=#what-to-do-with-deeptb-e3>#</a></h3><p>DeePTB-E3 model, after being trained, can predict DFT Hamiltonian with an extremely lower cost than conventional DFT. You can use DeePTB-E3:</p><ol class="arabic simple"><li><p>Do high-throughput calculations on Molecular Dynamics trajectory, combinations of structure, elements etc.</p></li><li><p>Predicting on large structure while training on the dataset of smaller ones.</p></li></ol></section></section><section id=practice><h2>Practice <a id=practice></a><a title="Link to this heading"class=headerlink href=#practice>#</a></h2><section id=prepare-the-data><h3><strong>1. Prepare the Data</strong> <a id=dataprepare></a><a title="Link to this heading"class=headerlink href=#prepare-the-data>#</a></h3><p>DeePTB need to calculate output from the LCAO DFT as the input dataset.</p><p>For illustration, we have prepared the dataset including crystalline silicon in DeePTB/examples/e3/data folder. The data are generated via ABACUS DFT software, using an SZP basis, containing one s and one p orbital. The cutoff of the LCAO basis is 7au, which indicates the largest bond should be smaller than 14au, which is around 7.408 angstrom. In DeePTB, we use angstroms as our length unit, and eV as the energy unit.</p><p>To make life easier, we provide <a class="reference external"href=https://github.com/floatingCatty/dftio>dftio</a> to transform the DFT output data into a trainable dataset format, we refer to the former tutorial and the front page of <a class="reference external"href=https://github.com/floatingCatty/dftio>dftio</a> repository for usage guide.</p><p>The directory of these examples looks like：</p><div class="highlight-bash notranslate"><div class=highlight><pre><span></span>deeptb/examples/e3/
<span class=p>|</span>--<span class=w> </span>band.json
<span class=p>|</span>--<span class=w> </span>band_plot.py
<span class=p>|</span>--<span class=w> </span>data
<span class=p>|</span><span class=w>   </span><span class=p>|</span>--<span class=w> </span>Si64.0
<span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>--<span class=w> </span>atomic_numbers.dat
<span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>--<span class=w> </span>basis.dat
<span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>--<span class=w> </span>cell.dat
<span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>--<span class=w> </span>hamiltonians.h5
<span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>--<span class=w> </span>kpoints.npy
<span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>--<span class=w> </span>overlaps.h5
<span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=p>|</span>--<span class=w> </span>pbc.dat
<span class=p>|</span><span class=w>   </span><span class=p>|</span><span class=w>   </span><span class=sb>`</span>--<span class=w> </span>positions.dat
<span class=p>|</span><span class=w>   </span><span class=p>|</span>--<span class=w> </span>Si64.vasp
<span class=p>|</span><span class=w>   </span><span class=sb>`</span>--<span class=w> </span>info.json
<span class=p>|</span>--<span class=w> </span>input_short.json
<span class=p>|</span>--<span class=w> </span>input_short_cpu.json
<span class=sb>`</span>--<span class=w> </span>ref_model
<span class=w>    </span><span class=sb>`</span>--<span class=w> </span>nnenv.ep1474.pth
</pre></div></div><p>We can see the data folder contains a single frame Si.0. To inform the <strong>DeePTB</strong> that this is a dataset, we need to write a very simple `info.json’, as:</p><div class="highlight-JSON notranslate"><div class=highlight><pre><span></span><span class=p>{</span>
<span class=w>        </span><span class=nt>"nframes"</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"pos_type"</span><span class=p>:</span><span class=w> </span><span class=s2>"cart"</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"pbc"</span><span class=p>:</span><span class=w> </span><span class=kc>true</span>
<span class=p>}</span>
</pre></div></div><p>Where ‘nframes’ indicates the <code class="docutils literal notranslate"><span class=pre>Si64.0</span></code> folder contains only a single structure, <code class="docutils literal notranslate"><span class=pre>pos_type</span></code> suggests the <code class="docutils literal notranslate"><span class=pre>positions.dat</span></code> is written with absolute position. and <code class="docutils literal notranslate"><span class=pre>pbc</span></code> suggest it is a system with periodic boundary conditions on all <code class="docutils literal notranslate"><span class=pre>x</span></code>, <code class="docutils literal notranslate"><span class=pre>y</span></code> and <code class="docutils literal notranslate"><span class=pre>z</span></code> plains.</p><p>Now we have already prepared a training dataset for DeePTB-E3.</p><p><strong>To make life easier</strong>, we highly recommend using <strong>dftio</strong> to prepare the data. With the DFT output, dftio can preprocess the data in parallel with only one line of command. Here we give an example to show.</p><div class="cell docutils container"><div class="cell_input docutils container"><div class="highlight-ipython3 notranslate"><div class=highlight><pre><span></span><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<span class=n>os</span><span class=o>.</span><span class=n>chdir</span><span class=p>(</span><span class=s2>"/root/soft/dftio/test/data"</span><span class=p>)</span>
</pre></div></div></div><div class="cell_output docutils container"><div class="output traceback highlight-ipythontb notranslate"><div class=highlight><pre><span></span><span class=gt>---------------------------------------------------------------------------</span>
<span class=ne>PermissionError</span><span class="g g-Whitespace">                           </span>Traceback (most recent call last)
<span class=n>Cell</span> <span class=n>In</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>line</span> <span class=mi>2</span>
<span class="g g-Whitespace">      </span><span class=mi>1</span> <span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<span class=ne>----> </span><span class=mi>2</span> <span class=n>os</span><span class=o>.</span><span class=n>chdir</span><span class=p>(</span><span class=s2>"/root/soft/dftio/test/data"</span><span class=p>)</span>

<span class=ne>PermissionError</span>: [Errno 13] Permission denied: '/root/soft/dftio/test/data'
</pre></div></div></div></div><p>In the folder, there sits an abacus DFT calculation results. The directory looks like:</p><div class="highlight-default notranslate"><div class=highlight><pre><span></span>abacus
|-- INPUT
|-- OUT.ABACUS
|   |-- INPUT
|   |-- STRU_SIMPLE.cif
|   |-- data-HR-sparse_SPIN0.csr
|   |-- istate.info
|   |-- kpoints
|   |-- running_scf.log
|   `-- warning.log
`-- STRU
</pre></div></div><p>We can transform this into the machine learning readable format with one line:</p><div class="cell docutils container"><div class="cell_input docutils container"><div class="highlight-ipython3 notranslate"><div class=highlight><pre><span></span><span class=o>!</span>dftio<span class=w> </span>parse<span class=w> </span>-r<span class=w> </span>./<span class=w> </span>-p<span class=w> </span>abacus<span class=w> </span>-o<span class=w> </span>./test<span class=w> </span>-ham
</pre></div></div></div></div><div class="cell docutils container"><div class="cell_input docutils container"><div class="highlight-ipython3 notranslate"><div class=highlight><pre><span></span><span class=o>!</span>tree<span class=w> </span>test
</pre></div></div></div></div><p>You can see the test folder we generated, containing the prepared data of a single MoS2 frame with its Hamiltonian. The command has several options. Here, the <code class="docutils literal notranslate"><span class=pre>-r</span></code> and <code class="docutils literal notranslate"><span class=pre>-p</span></code> indicate the root and prefix of the DFT output folders to be processed. For example, for a current folder with abacus as its name, we use <code class="docutils literal notranslate"><span class=pre>-r</span> <span class=pre>./</span></code> and <code class="docutils literal notranslate"><span class=pre>-p</span> <span class=pre>abacus</span></code>. The <code class="docutils literal notranslate"><span class=pre>-p</span></code> is the prefix that anchors on all the folders with this prefix string; therefore, by a single line, we can locate multiple DFT outputs. <code class="docutils literal notranslate"><span class=pre>-o</span></code> indicates the output directory, containing the processed data. Those are the essential flags.</p><p>Now, to decide which data should be processed, we need to specify the parsing of physical quantities. The tag includes <code class="docutils literal notranslate"><span class=pre>-ham</span></code>, <code class="docutils literal notranslate"><span class=pre>-ovp</span></code>, <code class="docutils literal notranslate"><span class=pre>-dm</span></code>, <code class="docutils literal notranslate"><span class=pre>-eig</span></code>, representing the Hamiltonian, Overlap Matrix, Density Matrix and the kpoints & energy eigenvalues. Here we use <code class="docutils literal notranslate"><span class=pre>-ham</span></code> so the processed folder will contain <code class="docutils literal notranslate"><span class=pre>hamiltonians.h5</span></code> parsed from <code class="docutils literal notranslate"><span class=pre>data-HR-sparse_SPIN0.csr</span></code> of the abacus output.</p><p>In extra, we can specify the DFT software used to generated your raw data by <code class="docutils literal notranslate"><span class=pre>-m</span></code>. The default <code class="docutils literal notranslate"><span class=pre>-m</span></code> value are <code class="docutils literal notranslate"><span class=pre>abacus</span></code>. Other supported DFT software includes: <code class="docutils literal notranslate"><span class=pre>gaussian</span></code>, <code class="docutils literal notranslate"><span class=pre>vasp</span></code>, <code class="docutils literal notranslate"><span class=pre>rescu</span></code> and <code class="docutils literal notranslate"><span class=pre>siesta</span></code>.</p><p>If you have a large amount of data, to parse it efficiently, you can use <code class="docutils literal notranslate"><span class=pre>-n</span> <span class=pre>j</span></code> tag to launch the j processors simultaneously to handle the data.</p></section><section id=model-training><h3><strong>2. Model Training</strong> <a id=train></a><a title="Link to this heading"class=headerlink href=#model-training>#</a></h3><p>The <code class="docutils literal notranslate"><span class=pre>input_short.json</span></code> file contains the least number of parameters that are required to start training the DeePTB-E3 model, we list some important parameters:</p><div class="highlight-JSON notranslate"><div class=highlight><pre><span></span><span class=nt>"common_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nt>"basis"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>"Si"</span><span class=p>:</span><span class=w> </span><span class=s2>"1s1p"</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>"device"</span><span class=p>:</span><span class=w> </span><span class=s2>"cpu"</span><span class=p>,</span>
<span class=w>    </span><span class=nt>"overlap"</span><span class=p>:</span><span class=w> </span><span class=kc>true</span>
<span class=p>}</span>
</pre></div></div><p>In <code class="docutils literal notranslate"><span class=pre>common_options</span></code>, here are the essential parameters. The <code class="docutils literal notranslate"><span class=pre>basis</span></code> should align with the DFT calculation, so 1 <code class="docutils literal notranslate"><span class=pre>s</span></code> and 1 <code class="docutils literal notranslate"><span class=pre>p</span></code> orbitals would result in a <code class="docutils literal notranslate"><span class=pre>1s1p</span></code> basis. The <code class="docutils literal notranslate"><span class=pre>device</span></code> can either be <code class="docutils literal notranslate"><span class=pre>cpu</span></code> or <code class="docutils literal notranslate"><span class=pre>cuda</span></code>, but we highly recommend using <code class="docutils literal notranslate"><span class=pre>cuda</span></code> if GPU is available. The <code class="docutils literal notranslate"><span class=pre>overlap</span></code> tag controls whether to fit the overlap matrix together. Benefitting from our parameterization, the fitting overlap only brings <strong>negligible costs</strong>, but is very convenient when using the model. So we highly suggest that you to do it.</p><p>Here comes the <code class="docutils literal notranslate"><span class=pre>model_options</span></code>:</p><div class="highlight-JSON notranslate"><div class=highlight><pre><span></span><span class=nt>"model_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nt>"embedding"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>"method"</span><span class=p>:</span><span class=w> </span><span class=s2>"slem"</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"r_max"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"Si"</span><span class=p>:</span><span class=w> </span><span class=mf>7.4</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>"irreps_hidden"</span><span class=p>:</span><span class=w> </span><span class=s2>"32x0e+32x1o+16x2e"</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"n_layers"</span><span class=p>:</span><span class=w> </span><span class=mi>3</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"avg_num_neighbors"</span><span class=p>:</span><span class=w> </span><span class=mi>51</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"tp_radial_emb"</span><span class=p>:</span><span class=w> </span><span class=kc>true</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>"prediction"</span><span class=p>:{</span>
<span class=w>        </span><span class=nt>"method"</span><span class=p>:</span><span class=w> </span><span class=s2>"e3tb"</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"neurons"</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=mi>64</span><span class=p>,</span><span class=mi>64</span><span class=p>]</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</pre></div></div><p>The <code class="docutils literal notranslate"><span class=pre>model_options</span></code> contains <code class="docutils literal notranslate"><span class=pre>embedding</span></code> and <code class="docutils literal notranslate"><span class=pre>prediction</span></code> parts, denoting the construction of representation for equivariant features, and arranging and rescaling the features into quantum operators sub-blocks such as Hamiltonian, density and overlap matrix.</p><p>In <code class="docutils literal notranslate"><span class=pre>embedding</span></code>, the <code class="docutils literal notranslate"><span class=pre>method</span></code> supports <code class="docutils literal notranslate"><span class=pre>slem</span></code> and <code class="docutils literal notranslate"><span class=pre>lem</span></code> for now, where <code class="docutils literal notranslate"><span class=pre>slem</span></code> has a strictly localised dependency, which has better transferability and data efficiency, while <code class="docutils literal notranslate"><span class=pre>lem</span></code> has an adjustable semi-local dependency, which has better representation capacity, but would require a little more data.</p><p><code class="docutils literal notranslate"><span class=pre>r_max</span></code> stands for the maximum bond length. Since the cutoff radius for the DFT LCAO orbital is 7 au, which means the largest bond would be less than 14 au. Therefore, it should be set as 7.4 angstrom.</p><p>For <code class="docutils literal notranslate"><span class=pre>irreps_hidden</span></code>, this parameter defines the size of the hidden equivariant irreducible representation, which decides most of the power of the model. There are certain rules to define this parameter. But for quick usage, we provide a tool to do basis analysis to extract essential irreps:</p><div class="highlight-IPYTHON notranslate"><div class=highlight><pre><span></span><span class=n>In</span> <span class=p>[</span><span class=mi>1</span><span class=p>]:</span> <span class=kn>from</span><span class=w> </span><span class=nn>dptb.data</span><span class=w> </span><span class=kn>import</span> <span class=n>OrbitalMapper</span>

<span class=n>In</span> <span class=p>[</span><span class=mi>2</span><span class=p>]:</span> <span class=n>idp</span> <span class=o>=</span> <span class=n>OrbitalMapper</span><span class=p>(</span><span class=n>basis</span><span class=o>=</span><span class=p>{</span><span class=s2>"Si"</span><span class=p>:</span> <span class=s2>"1s1p"</span><span class=p>})</span>

<span class=n>In</span> <span class=p>[</span><span class=mi>3</span><span class=p>]:</span> <span class=n>idp</span><span class=o>.</span><span class=n>get_irreps_ess</span><span class=p>()</span>
<span class=n>Out</span><span class=p>[</span><span class=mi>3</span><span class=p>]:</span> <span class=mi>2</span><span class=n>x0e</span><span class=o>+</span><span class=mi>1</span><span class=n>x1o</span><span class=o>+</span><span class=mi>1</span><span class=n>x2e</span>
</pre></div></div><p>This is the number of independent irreps contained in the basis. Irreps configured should be multiple times of this essential irreps. The number can vary with a pretty large freedom, but all the types, for example (“0e”, “1o”, “2e”) here, should be included for all. We usually take a descending order starting from “32”, “64”, or “128” for the first “0e” and decay by half for the latter high-order irreps. For general rules of the irreps, the user can read the advanced topics in the DeePTB document, but for now, you are safe to ignore!</p><p><code class="docutils literal notranslate"><span class=pre>n_layers</span></code> is the number of hidden layers of the embedding networks, usually it should be set between 3-5. <code class="docutils literal notranslate"><span class=pre>avg_num_neighbors</span></code> is the normalisation constant of the node feature.<code class="docutils literal notranslate"><span class=pre>tp_radial_emb</span></code> is a bool type value, representing whether to explicitly include radial information in the SO2 tensor product.</p><p>In <code class="docutils literal notranslate"><span class=pre>prediction</span></code>, we should use the <code class="docutils literal notranslate"><span class=pre>e3tb</span></code> method to require the model output features using <strong>DeePTB-E3</strong> format. The neurons are defined for a simple MLP to predict the slater-koster-like parameters for predicting the overlap matrix, for which [64,64] is usually fine.</p><p>Now everything is prepared! We can using the following command and we can train the first model:</p><div class="cell docutils container"><div class="cell_input docutils container"><div class="highlight-ipython3 notranslate"><div class=highlight><pre><span></span><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<span class=n>os</span><span class=o>.</span><span class=n>chdir</span><span class=p>(</span><span class=s2>"/root/soft/DeePTB/examples/e3"</span><span class=p>)</span>
</pre></div></div></div></div><div class="cell docutils container"><div class="cell_input docutils container"><div class="highlight-ipython3 notranslate"><div class=highlight><pre><span></span><span class=c1># Run the training</span>
<span class=c1># GPU: </span>
<span class=o>!</span>dptb<span class=w> </span>train<span class=w> </span>././input_short_cpu.json<span class=w> </span>-o<span class=w> </span>./e3_silicon
<span class=c1># If GPU is not available, please comment the line above and use the command below.</span>
<span class=c1>#!dptb train ./input_short_cpu.json -o ./e3_silicon</span>
</pre></div></div></div></div><p>Here <code class="docutils literal notranslate"><span class=pre>-o</span></code> indicates the output directory. During the fitting procedure, we can see that the loss curve of hBN decreases consistently. When finished, we get the fitting results in folders <code class="docutils literal notranslate"><span class=pre>e3_silicon</span></code>.</p><p>Aftering training, we can use directly our model for electronic structure calculation. Since overlap is fitted along with others, the calculation can be used independently to the source DFT software. Here we illustrate this with electron band structure plotting. We can directly run the prepared band plotting config:</p><p>训练完成后，我们可以画图看看能带拟合怎么样了，需要准备这样的能带绘制参数：</p><div class="highlight-json notranslate"><div class=highlight><pre><span></span><span class=p>{</span><span class=w>   </span>
<span class=w>    </span><span class=nt>"task_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>"task"</span><span class=p>:</span><span class=w> </span><span class=s2>"band"</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"kline_type"</span><span class=p>:</span><span class=s2>"abacus"</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"kpath"</span><span class=p>:[</span>
<span class=w>                </span><span class=p>[</span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>20</span><span class=p>],</span><span class=w>   </span>
<span class=w>                </span><span class=p>[</span><span class=mf>0.5000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>1</span><span class=p>],</span><span class=w>               </span>
<span class=w>                </span><span class=p>[</span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.5000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>20</span><span class=p>],</span><span class=w>    </span>
<span class=w>                </span><span class=p>[</span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>20</span><span class=p>],</span><span class=w>     </span>
<span class=w>                </span><span class=p>[</span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.5000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>1</span><span class=p>],</span><span class=w>    </span>
<span class=w>                </span><span class=p>[</span><span class=mf>-0.500000000</span><span class=p>,</span><span class=w>  </span><span class=mf>-0.5000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.5000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>20</span><span class=p>],</span><span class=w>                </span>
<span class=w>                </span><span class=p>[</span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>20</span><span class=p>],</span><span class=w>               </span>
<span class=w>                </span><span class=p>[</span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>  </span><span class=mf>-0.5000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.5000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>1</span><span class=w> </span><span class=p>],</span>
<span class=w>                </span><span class=p>[</span><span class=mf>-0.500000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.5000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>20</span><span class=p>],</span>
<span class=w>                </span><span class=p>[</span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>20</span><span class=p>],</span>
<span class=w>                </span><span class=p>[</span><span class=mf>0.5000000000</span><span class=p>,</span><span class=w>  </span><span class=mf>-0.5000000000</span><span class=p>,</span><span class=w>   </span><span class=mf>0.0000000000</span><span class=p>,</span><span class=w>   </span><span class=mi>1</span><span class=w> </span><span class=p>]</span>
<span class=w>                </span><span class=p>],</span>
<span class=w>        </span><span class=nt>"klabels"</span><span class=p>:[</span><span class=s2>"G"</span><span class=p>,</span><span class=s2>"X"</span><span class=p>,</span><span class=s2>"Y"</span><span class=p>,</span><span class=s2>"G"</span><span class=p>,</span><span class=s2>"Z"</span><span class=p>,</span><span class=s2>"R_2"</span><span class=p>,</span><span class=s2>"G"</span><span class=p>,</span><span class=s2>"T_2"</span><span class=p>,</span><span class=s2>"U_2"</span><span class=p>,</span><span class=s2>"G"</span><span class=p>,</span><span class=s2>"V_2"</span><span class=p>],</span>
<span class=w>        </span><span class=nt>"nel_atom"</span><span class=p>:{</span><span class=nt>"Si"</span><span class=p>:</span><span class=mi>4</span><span class=p>},</span>
<span class=w>        </span><span class=nt>"E_fermi"</span><span class=p>:</span><span class=mf>0.0</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"emin"</span><span class=p>:</span><span class=mi>-7</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"emax"</span><span class=p>:</span><span class=mi>18</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</pre></div></div><div class="cell docutils container"><div class="cell_input docutils container"><div class="highlight-ipython3 notranslate"><div class=highlight><pre><span></span><span class=o>!</span>dptb<span class=w> </span>run<span class=w> </span>band.json<span class=w> </span>-i<span class=w> </span>./ref_model/nnenv.ep1474.pth<span class=w> </span>-o<span class=w> </span>band<span class=w> </span>-stu<span class=w> </span>./data/Si64.vasp

<span class=c1># display the band plot:</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.image</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>mpimg</span>
<span class=n>image_path</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>'./band/results/band.png'</span>
<span class=n>img</span> <span class=o>=</span> <span class=n>mpimg</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=n>image_path</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>8</span><span class=p>))</span>
<span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>'off'</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</pre></div></div></div><div class="cell_output docutils container"><div class="output stream highlight-myst-ansi notranslate"><div class=highlight><pre><span></span>TBPLaS is not installed. Thus the TBPLaS is not available, Please install it first.
 
 
#################################################################################
#                                                                               #
#                                                                               #
#      ██████████                     ███████████  ███████████ ███████████      #
#     ░░███░░░░███                   ░░███░░░░░███░█░░░███░░░█░░███░░░░░███     #
#      ░███   ░░███  ██████   ██████  ░███    ░███░   ░███  ░  ░███    ░███     #
#      ░███    ░███ ███░░███ ███░░███ ░██████████     ░███     ░██████████      #
#      ░███    ░███░███████ ░███████  ░███░░░░░░      ░███     ░███░░░░░███     #
#      ░███    ███ ░███░░░  ░███░░░   ░███            ░███     ░███    ░███     #
#      ██████████  ░░██████ ░░██████  █████           █████    ███████████      #
#     ░░░░░░░░░░    ░░░░░░   ░░░░░░  ░░░░░           ░░░░░    ░░░░░░░░░░░       #
#                                                                               #
#                         Version: 2.0.4.dev93+ea00a42                          #
#                                                                               #
#################################################################################
 
 
DEEPTB WARNING CUDA is not available. The model will be loaded on CPU.
/opt/mamba/lib/python3.10/site-packages/torch/nested/__init__.py:107: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. (Triggered internally at ../aten/src/ATen/NestedTensorImpl.cpp:178.)
  return torch._nested_tensor_from_tensor_list(ts, dtype, None, device, None)
DEEPTB INFO    KPOINTS  klist: 144 kpoints
DEEPTB INFO    The eigenvalues are already in data. will use them.
DEEPTB INFO    Calculating Fermi energy in the case of spin-degeneracy.
DEEPTB INFO    Fermi energy converged after 4 iterations.
DEEPTB INFO    q_cal: 256.00000000000273, total_electrons: 256.0, diff q: 2.7284841053187847e-12
DEEPTB INFO    Estimated E_fermi: 7.604284664534169 based on the valence electrons setting nel_atom : {'Si': 4} .
DEEPTB INFO    Using input Fermi energy: 0.0000 eV (estimated: 7.6043 eV)
Figure(640x560)
DEEPTB INFO    band calculation successfully completed.
</pre></div></div><img alt=../../_images/c1d0a8eb21dd4d13cbf1170410096a26a33e5a11e1dda02370a2c56d004270b5.png src=../../_images/c1d0a8eb21dd4d13cbf1170410096a26a33e5a11e1dda02370a2c56d004270b5.png><div class="output traceback highlight-ipythontb notranslate"><div class=highlight><pre><span></span><span class=ne>Error</span>: INVALID mime type: status. Must be in the format "type/subtype[;optionalparameter]"

    <span class=n>at</span> <span class=n>new</span> <span class=n>Js</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>107</span><span class=p>:</span><span class=mi>50823</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Function</span><span class=o>.</span><span class=n>text</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>107</span><span class=p>:</span><span class=mi>50653</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>c</span> <span class=p>(</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>extensions</span><span class=o>/</span><span class=n>ipynb</span><span class=o>/</span><span class=n>dist</span><span class=o>/</span><span class=n>ipynbMain</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>140468</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>l</span> <span class=p>(</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>extensions</span><span class=o>/</span><span class=n>ipynb</span><span class=o>/</span><span class=n>dist</span><span class=o>/</span><span class=n>ipynbMain</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>141345</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>h</span> <span class=p>(</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>extensions</span><span class=o>/</span><span class=n>ipynb</span><span class=o>/</span><span class=n>dist</span><span class=o>/</span><span class=n>ipynbMain</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>141855</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Array</span><span class=o>.</span><span class=n>map</span> <span class=p>(</span><span class=o><</span><span class=n>anonymous</span><span class=o>></span><span class=p>)</span>

    <span class=n>at</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>extensions</span><span class=o>/</span><span class=n>ipynb</span><span class=o>/</span><span class=n>dist</span><span class=o>/</span><span class=n>ipynbMain</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>138791</span>

    <span class=n>at</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>extensions</span><span class=o>/</span><span class=n>ipynb</span><span class=o>/</span><span class=n>dist</span><span class=o>/</span><span class=n>ipynbMain</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>139108</span>

    <span class=n>at</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>extensions</span><span class=o>/</span><span class=n>ipynb</span><span class=o>/</span><span class=n>dist</span><span class=o>/</span><span class=n>ipynbMain</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>139115</span>

    <span class=n>at</span> <span class=n>Array</span><span class=o>.</span><span class=n>map</span> <span class=p>(</span><span class=o><</span><span class=n>anonymous</span><span class=o>></span><span class=p>)</span>

    <span class=n>at</span> <span class=n>e</span><span class=o>.</span><span class=n>jupyterNotebookModelToNotebookData</span> <span class=p>(</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>extensions</span><span class=o>/</span><span class=n>ipynb</span><span class=o>/</span><span class=n>dist</span><span class=o>/</span><span class=n>ipynbMain</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>138367</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>deserializeNotebook</span> <span class=p>(</span><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>extensions</span><span class=o>/</span><span class=n>ipynb</span><span class=o>/</span><span class=n>dist</span><span class=o>/</span><span class=n>ipynbMain</span><span class=o>.</span><span class=n>node</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>1</span><span class=p>:</span><span class=mi>168812</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>xh</span><span class=o>.</span><span class=err>$</span><span class=n>dataToNotebook</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>172</span><span class=p>:</span><span class=mi>16837</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>i4</span><span class=o>.</span><span class=n>S</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>160882</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>i4</span><span class=o>.</span><span class=n>Q</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>160662</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>i4</span><span class=o>.</span><span class=n>M</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>159713</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>i4</span><span class=o>.</span><span class=n>L</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>158989</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Ah</span><span class=o>.</span><span class=n>value</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>157653</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>P</span><span class=o>.</span><span class=n>B</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>2375</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>P</span><span class=o>.</span><span class=n>fire</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>2593</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Jn</span><span class=o>.</span><span class=n>fire</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>9459</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Ah</span><span class=o>.</span><span class=n>value</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>197</span><span class=p>:</span><span class=mi>3917</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>P</span><span class=o>.</span><span class=n>B</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>2375</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>P</span><span class=o>.</span><span class=n>fire</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>2593</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Jn</span><span class=o>.</span><span class=n>fire</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>9459</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Km</span><span class=o>.</span><span class=n>A</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>12575</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Ah</span><span class=o>.</span><span class=n>value</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>11976</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>P</span><span class=o>.</span><span class=n>B</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>2375</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>P</span><span class=o>.</span><span class=n>fire</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>2593</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>M6</span><span class=o>.</span><span class=n>acceptChunk</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>7942</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Ah</span><span class=o>.</span><span class=n>value</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>7228</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>P</span><span class=o>.</span><span class=n>B</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>2375</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>P</span><span class=o>.</span><span class=n>fire</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>27</span><span class=p>:</span><span class=mi>2593</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>AT</span><span class=o>.</span><span class=n>z</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>21747</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>AT</span><span class=o>.</span><span class=n>acceptFrame</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>21553</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>DT</span><span class=o>.</span><span class=n>n</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>20080</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>17312</span>

    <span class=n>at</span> <span class=n>Socket</span><span class=o>.</span><span class=n>t</span> <span class=p>(</span><span class=n>file</span><span class=p>:</span><span class=o>///</span><span class=n>home</span><span class=o>/</span><span class=n>qgwsl</span><span class=o>/.</span><span class=n>vscode</span><span class=o>-</span><span class=n>server</span><span class=o>/</span><span class=nb>bin</span><span class=o>/</span><span class=mi>17</span><span class=n>baf841131aa23349f217ca7c570c76ee87b957</span><span class=o>/</span><span class=n>out</span><span class=o>/</span><span class=n>vs</span><span class=o>/</span><span class=n>workbench</span><span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>node</span><span class=o>/</span><span class=n>extensionHostProcess</span><span class=o>.</span><span class=n>js</span><span class=p>:</span><span class=mi>29</span><span class=p>:</span><span class=mi>15252</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Socket</span><span class=o>.</span><span class=n>emit</span> <span class=p>(</span><span class=n>node</span><span class=p>:</span><span class=n>events</span><span class=p>:</span><span class=mi>518</span><span class=p>:</span><span class=mi>28</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>addChunk</span> <span class=p>(</span><span class=n>node</span><span class=p>:</span><span class=n>internal</span><span class=o>/</span><span class=n>streams</span><span class=o>/</span><span class=n>readable</span><span class=p>:</span><span class=mi>561</span><span class=p>:</span><span class=mi>12</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>readableAddChunkPushByteMode</span> <span class=p>(</span><span class=n>node</span><span class=p>:</span><span class=n>internal</span><span class=o>/</span><span class=n>streams</span><span class=o>/</span><span class=n>readable</span><span class=p>:</span><span class=mi>512</span><span class=p>:</span><span class=mi>3</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>Socket</span><span class=o>.</span><span class=n>Readable</span><span class=o>.</span><span class=n>push</span> <span class=p>(</span><span class=n>node</span><span class=p>:</span><span class=n>internal</span><span class=o>/</span><span class=n>streams</span><span class=o>/</span><span class=n>readable</span><span class=p>:</span><span class=mi>392</span><span class=p>:</span><span class=mi>5</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>TCP</span><span class=o>.</span><span class=n>onStreamRead</span> <span class=p>(</span><span class=n>node</span><span class=p>:</span><span class=n>internal</span><span class=o>/</span><span class=n>stream_base_commons</span><span class=p>:</span><span class=mi>191</span><span class=p>:</span><span class=mi>23</span><span class=p>)</span>

    <span class=n>at</span> <span class=n>TCP</span><span class=o>.</span><span class=n>callbackTrampoline</span> <span class=p>(</span><span class=n>node</span><span class=p>:</span><span class=n>internal</span><span class=o>/</span><span class=n>async_hooks</span><span class=p>:</span><span class=mi>130</span><span class=p>:</span><span class=mi>17</span><span class=p>)</span>
</pre></div></div></div></div><p>Now you know how to train a <strong>DeePTB-E3</strong> model to predict Hamiltonian Matrix and Overlap Matrix. If you want further introduction of the features and more advanced usages, please read the <a class="reference external"href=https://deeptb.readthedocs.io/en/latest/>official document</a> of <strong>DeePTB</strong>.</p></section></section><section id=more-method><h2>More Method<a id=moremethod></a><a title="Link to this heading"class=headerlink href=#more-method>#</a></h2><p><strong>DeePTB-E3</strong> are functions based on the core design of a Strictly Local Equivariant Message Passing network (SLEM) model to represent single-electron operator matrices, including the Hamiltonian, density matrix, overlap matrix, and so on. This innovative approach is intended to accelerate first-principles electronic structure and property calculations. DeePTB employs an equivariant representation for the density matrix and Hamiltonian, whereas for overlap integrals, though they can also be represented equivariantly, given their strictly two-centre character, we achieve a more efficient invariant representation via Slater–Koster parameterisation.</p><section id=parametrization-of-the-equivariant-representation><h3>Parametrization of the Equivariant Representation: <a id=e3representation></a><a title="Link to this heading"class=headerlink href=#parametrization-of-the-equivariant-representation>#</a></h3><p>In the LCAO-basis DFT framework, a single-electron operator <span class="math notranslate nohighlight">\(\hat{O}\)</span> (such as the Hamiltonian or density matrix) obeys equivariance under the E(3) group, and thus can be expressed using tensorized features from group theory. The E(3) group includes spatial rotations, translations, and reflections. Translation symmetry is automatically satisfied by operating only on relative coordinates, whereas rotations and reflections require explicit treatment.</p><p>In the LCAO basis, the matrix elements of <span class="math notranslate nohighlight">\(\hat{O}\)</span> are written as:</p><div class="math notranslate nohighlight">\[O^{i,j}_{l_1,l_2,m_1,m_2} = \langle i, l_1, m_1 | \hat{O} | j, l_2, m_2 \rangle\]</div><p>where <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> label atomic positions, and <span class="math notranslate nohighlight">\(l_1,m_1\)</span> and <span class="math notranslate nohighlight">\(l_2,m_2\)</span> denote the orbitals at positions <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> respectively. Here, <span class="math notranslate nohighlight">\(m_1\)</span> and <span class="math notranslate nohighlight">\(m_2\)</span> are the magnetic quantum numbers associated with angular momenta <span class="math notranslate nohighlight">\(l_1\)</span> and <span class="math notranslate nohighlight">\(l_2\)</span>.</p><p>Under a rotation <span class="math notranslate nohighlight">\(R\)</span> of the system coordinates, equivariance demands that the operator matrix elements transform as: $<span class="math notranslate nohighlight">\(O'^{i,j}_{l_1,l_2,m'_1,m'_2} = \sum_{m_1,m_2} D(R)^{l_1}_{m_1,m'_1} D^*(R)^{l_2}_{m_2,m'_2} O^{i,j}_{l_1,l_2,m_1,m_2}\)</span>$</p><p>where <span class="math notranslate nohighlight">\(O'\)</span> is the rotated (equivariant) representation matrix and <span class="math notranslate nohighlight">\(D(R)^l_{m,m'}\)</span> is the Wigner-D matrix of order <span class="math notranslate nohighlight">\(l\)</span>.</p><p>Applying the Wigner–Eckart theorem, we can decompose the operator into irreducible features:</p><div class="math notranslate nohighlight">\[o^{i,j}_{l_3,m_3} = \sum_{l_1,m_1,l_2,m_2} C^{(l_3,m_3)}_{(l_1,m_1)(l_2,m_2)} O^{i,j}_{l_1,l_2,m_1,m_2}\]</div><p>Here <span class="math notranslate nohighlight">\(l_3\)</span> ranges over <span class="math notranslate nohighlight">\(\lvert l_1 - l_2\rvert \le l_3 \le l_1 + l_2\)</span>. Edge <span class="math notranslate nohighlight">\((i\neq j)\)</span> and node <span class="math notranslate nohighlight">\((i=j)\)</span> features <span class="math notranslate nohighlight">\(o^{i,j}_{l_3,m_3}\)</span> are grouped by the index <span class="math notranslate nohighlight">\(m\)</span> into vectors <span class="math notranslate nohighlight">\(\mathbf{o}^{i,j}_{c,l}\)</span>, where <span class="math notranslate nohighlight">\(c\)</span> indexes the multiplicity of each <span class="math notranslate nohighlight">\(l\)</span>. To align with the network outputs, we normalise these target features:</p><div class="math notranslate nohighlight">\[o^{i,i/j}_{c,l} = \sigma^{Z_i,Z_{i/j}}_{c,l} \hat{o}^{i,i/j}_{c,l} + \mu^{Z_i,Z_{i/j}}_{c,l} \delta_{l,0}\]</div><p>where <span class="math notranslate nohighlight">\(Z_i, Z_j\)</span> are atomic numbers of atoms <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>, and <span class="math notranslate nohighlight">\(\sigma^{Z_i,Z_{i/j}}_{c,l}\)</span> and <span class="math notranslate nohighlight">\(\mu^{Z_i,Z_{i/j}}_{c,l}\)</span> are dataset‐derived scale and bias parameters for each atom or atom‐pair.</p><p>The network is trained to produce aggregated node and edge features <span class="math notranslate nohighlight">\(\mathbf{n}^i_{c,l}, \mathbf{e}^{ij}_{c,l}\)</span> that supervise the decomposed target features <span class="math notranslate nohighlight">\(\hat{o}^{i,i}_{c,l}\)</span> and <span class="math notranslate nohighlight">\(\hat{o}^{i,j}_{c,l}\)</span>. Finally, we reconstruct the predicted operator matrix via the inverse Wigner–Eckart transform:</p><div class="math notranslate nohighlight">\[O^{i,j}_{l_1,l_2,m_1,m_2} = \sum_{l_3,m_3} C^{(l_3,m_3)}_{(l_1,m_1)(l_2,m_2)} o^{i,j}_{l_3,m_3}\]</div><p>This procedure ensures the representation respects rotational, translational, and reflection symmetries.</p></section><section id=invariant-representation-of-overlap-integrals><h3>Invariant Representation of Overlap Integrals <a id=overlaprepresentation></a><a title="Link to this heading"class=headerlink href=#invariant-representation-of-overlap-integrals>#</a></h3><p>The overlap matrix is defined as:</p><div class="math notranslate nohighlight">\[S^{i,j}_{l_1,l_2,m_1,m_2} = \langle i, l_1, m_1 | j, l_2, m_2 \rangle = \int \phi^{i,l_1}_{m_1}(r)\phi^{j,l_2}_{m_2}(r - r_{ij})dr\]</div><p>where <span class="math notranslate nohighlight">\(\phi^{i,l}_{m}\)</span> are the LCAO basis functions. The overlap matrix naturally satisfies equivariance. Since this property derives entirely from the basis functions, we can rotate them so that the bond vector <span class="math notranslate nohighlight">\(r_{ij}\)</span> aligns with the <span class="math notranslate nohighlight">\(z\)</span>-axis, reducing the matrix elements to scalars via:</p><div class="math notranslate nohighlight">\[\int \phi^{\prime i,l_1}_{m_1}(r)\phi^{\prime j l_2}_{m_2}(r - r_{ij})dr = s^{Z_i,Z_j}_{l_1,l_2,|m_1|}(r_{ij}) \delta_{m_1,m_2}\]</div><p>Here <span class="math notranslate nohighlight">\(\phi'\)</span> denotes the orbitals rotated into the bond-aligned frame. The integral depends only on the two-centre parameters <span class="math notranslate nohighlight">\(Z_i, Z_j,\)</span> and <span class="math notranslate nohighlight">\(r_{ij}\)</span>. We then learn a mapping from these atomic types and bond lengths to the scalar overlap parameters via a small MLP:</p><div class="math notranslate nohighlight">\[f_{l_1,l_2,|m|}(Z_i, Z_j, r_{ij}) = s^{Z_i,Z_j}_{l_1,l_2,|m_1|}(r_{ij}) \delta_{m_1,m_2}\]</div><p>Using these learned scalars, we build the overlap matrix in the bond-aligned frame and then rotate it back to the original coordinate system.</p></section><section id=model-architecture><h3>Model Architecture <a id=modelarchitecture></a><a title="Link to this heading"class=headerlink href=#model-architecture>#</a></h3><p>The <strong>DeePTB-E3</strong> module’s central innovation is the Strictly Local Equivariant Message Passing (SLEM) model for representing single-electron operator matrices. The SLEM architecture comprises:</p><ol class="arabic simple"><li><p><strong>Input Encoding:</strong> Encode atomic types, coordination numbers, distances, and other physico-chemical information into scalar hidden-state features.</p></li><li><p><strong>Feature Initialisation:</strong> Initialise edge features, hidden‐state features, and node features using the encoded scalars and spherical harmonics.</p></li><li><p><strong>Feature Update Modules:</strong> Iteratively update hidden‐state, node, and edge features via a series of strictly local node/edge message‐passing operations.</p></li><li><p><strong>Quantum Operator Reconstruction:</strong> Reconstruct the Hamiltonian, density matrix, and other operator representations from the updated node and edge features.</p></li></ol><div align=center><img src=https://bohrium.oss-cn-zhangjiakou.aliyuncs.com/article/593/2531d58f538647d4905fd8926d29a202/feea3610-4e80-4dc0-a735-a0034f477a64.png style=zoom:25%></div><p>The SLEM update rules can be summarised by: $$</p><div class="amsmath math notranslate nohighlight">\[\begin{align*} \mathbf{V}^{ij,L}&=\mathcal{V}_L\left(\mathbf{n}^{i,L-1},\mathbf{V}^{ij,L-1}\right)\\ \mathbf{e}^{ij,L}&=\mathcal{N}_L\left(\mathbf{e}^{ij,L-1},\mathbf{n}^{i,L-1},\mathbf{V}^{ij,L},\mathbf{n}^{j,L-1}\right)\\ \mathbf{m}^{ij,L}&=M_L\left(\mathbf{n}^{i,L-1},\mathbf{V}^{ij,L}\right)\\ \mathbf{n}^{i,L}&=U_L\left(\mathbf{n}^{i,L-1},\sum_{j\in\mathcal{N}(i)}\mathbf{m}^{ij,L}\right) \end{align*}\]</div><p>$$</p><p>For further methodological details, see the <a class="reference external"href=https://openreview.net/pdf?id=kpq3IIjUD3>SLEM paper</a>.</p></section></section></section></article><footer class="prev-next-footer d-print-none"><div class=prev-next-area><a title="previous page"class=left-prev href=tutorial3_train_si.html> <i class="fa-solid fa-angle-left"></i> <div class=prev-next-info><p class=prev-next-subtitle>previous</p><p class=prev-next-title>Tutorial 3: Training deeptb-sk model for Silicon</p></div> </a><a title="next page"class=right-next href=../basic_api.html> <div class=prev-next-info><p class=prev-next-subtitle>next</p><p class=prev-next-title>Basic API</p></div> <i class="fa-solid fa-angle-right"></i> </a></div></footer></div><div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner"><div class=sidebar-secondary-item><div class="page-toc tocsection onthispage"><i class="fa-solid fa-list"></i> Contents</div><nav class="bd-toc-nav page-toc"><ul class="visible nav section-nav flex-column"><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#introduction>Introduction</a><ul class="nav section-nav flex-column"><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#version-features>Version Features</a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#learning-objectives>Learning Objectives</a></li></ul></li><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#content>Content</a></li><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#method>Method: <a id=method></a></a><ul class="nav section-nav flex-column"><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#what-is-deeptb-e3>What is DeePTB-E3: <a id=whatis></a></a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#what-to-do-with-deeptb-e3>What to do with DeePTB-E3 <a id=whattodo></a></a></li></ul></li><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#practice>Practice <a id=practice></a></a><ul class="nav section-nav flex-column"><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#prepare-the-data><strong>1. Prepare the Data</strong> <a id=dataprepare></a></a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#model-training><strong>2. Model Training</strong> <a id=train></a></a></li></ul></li><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#more-method>More Method<a id=moremethod></a></a><ul class="nav section-nav flex-column"><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#parametrization-of-the-equivariant-representation>Parametrization of the Equivariant Representation: <a id=e3representation></a></a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#invariant-representation-of-overlap-integrals>Invariant Representation of Overlap Integrals <a id=overlaprepresentation></a></a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#model-architecture>Model Architecture <a id=modelarchitecture></a></a></li></ul></li></ul></nav></div></div></div></div><footer class=bd-footer-content><div class="bd-footer-content__inner container"><div class=footer-item><p class=component-author>By DeePTB</p></div><div class=footer-item><p class=copyright>© Copyright 2023, DeePTB. <br></p></div><div class=footer-item></div><div class=footer-item><div class=extra_footer><p><a href=https://beian.miit.gov.cn target=_blank>京ICP备20010051号-8</a></p></div></div></div></footer></main></div></div><script src=../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b></script><script src=../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b></script><footer class=bd-footer></footer></body></html>
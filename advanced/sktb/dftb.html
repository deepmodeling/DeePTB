<!doctypehtml><html data-content_root=../../ lang=en><head><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0 name=viewport><meta content=width=device-width,initial-scale=1 name=viewport><title>DFTB SK Files to DeePTB Model — DeePTB  documentation</title><script data-cfasync=false>document.documentElement.dataset.mode=localStorage.getItem(`mode`)||``;document.documentElement.dataset.theme=localStorage.getItem(`theme`)||``</script><link href=../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b rel=stylesheet><link href=../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b rel=stylesheet><link href=../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b rel=stylesheet><link href=../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b rel=stylesheet><link as=font crossorigin href=../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2 rel=preload type=font/woff2><link as=font crossorigin href=../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2 rel=preload type=font/woff2><link as=font crossorigin href=../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2 rel=preload type=font/woff2><link href=../../_static/pygments.css?v=8f2a1f02 rel=stylesheet><link href=../../_static/styles/sphinx-book-theme.css?v=eba8b062 rel=stylesheet><link href=../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css rel=stylesheet><link href=../../_static/banner.css?v=f1520836 rel=stylesheet><link as=script href=../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b rel=preload><link as=script href=../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b rel=preload><script src=../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b></script><script src=../../_static/documentation_options.js?v=9eb32ce0></script><script src=../../_static/doctools.js?v=9bcbadda></script><script src=../../_static/sphinx_highlight.js?v=dc90522c></script><script src=../../_static/scripts/sphinx-book-theme.js?v=887ef09a></script><script src=../../_static/banner.js?v=a6a668d4></script><script>DOCUMENTATION_OPTIONS.pagename=`advanced/sktb/dftb`</script><link href=../../genindex.html rel=index title=Index><link href=../../search.html rel=search title=Search><link title="Environment-dependent TB"href=dptb_env.html rel=next><link title="DeePTB-SK Advanced"href=index.html rel=prev><meta content=width=device-width,initial-scale=1 name=viewport><meta content=en name=docsearch:language><link href=https://unpkg.com/ rel=preconnect><link href=https://unpkg.com/@njzjz/icons@0.0.5/logos/deepmodeling.svg rel=icon type=image/png><div class="container-fluid header-holder tutorials-header"id=header-holder><div class=container><div class=header-container><a aria-label=deepmodeling class=header-logo href=https://deepmodeling.com></a><div class=main-menu><ul><li><a href=https://deepmodeling.com>Home</a></li><li><a href=https://blogs.deepmodeling.com>Blog</a></li><li><a href=https://tutorials.deepmodeling.com>Tutorials</a></li><li class="active docs-active"><div class=resources-dropdown data-toggle=resources-dropdown id=resourcesDropdownButton><a class="resource-option with-down-orange-arrow"href=https://docs.deepmodeling.com/> Docs </a><div class=resources-dropdown-menu><a class="doc-dropdown-option nav-dropdown-item"href=https://docs.deepmodeling.com/projects/deepmd/> <span class=dropdown-title>DeePMD-kit</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://docs.deepmodeling.com/projects/dpgen/> <span class=dropdown-title>DP-GEN</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://docs.deepmodeling.com/projects/dpdata/> <span class=dropdown-title>dpdata</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://docs.deepmodeling.com/projects/dpdispatcher/> <span class=dropdown-title>DPDispatcher</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://abacus.deepmodeling.com/> <span class=dropdown-title>ABACUS</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://deepflame.deepmodeling.com/> <span class=dropdown-title>DeepFlame</span> <p></p> </a><a class="doc-dropdown-option nav-dropdown-item"href=https://docs.deepmodeling.com/projects/dpti/> <span class=dropdown-title>DPTI</span> <p></p> </a></div></div></li><li><a href=https://blogs.deepmodeling.com/papers/>Publications</a></li><li><a href=https://github.com/deepmodeling>GitHub</a></li></ul></div><a class=main-menu-open-button data-behavior=open-mobile-menu href=#></a></div></div></div><div class=mobile-main-menu><div class=container-fluid><div class=container><div class=mobile-main-menu-header-container><a aria-label=deepmodeling class=header-logo href=https://deepmodeling.com></a><a class=main-menu-close-button data-behavior=close-mobile-menu href=#></a></div></div></div><div class=mobile-main-menu-links-container><div class=main-menu><ul><li><a href=https://deepmodeling.com>Home</a></li><li><a href=https://blogs.deepmodeling.com>Blog</a></li><li><a href=https://tutorials.deepmodeling.com>Tutorials</a></li><li><a href=https://docs.deepmodeling.com/>Docs</a></li><li><a href=https://blogs.deepmodeling.com/papers/>Publications</a></li><li><a href=https://github.com/deepmodeling>GitHub</a></li></ul></div></div></div></head><body data-bs-root-margin="0px 0px -60%"data-bs-spy=scroll data-bs-target=.bd-toc-nav data-default-mode data-offset=180><div class="skip-link d-print-none"id=pst-skip-link><a href=#main-content>Skip to main content</a></div><div id=pst-scroll-pixel-helper></div><button class="btn rounded-pill"id=pst-back-to-top type=button><i class="fa-solid fa-arrow-up"></i>Back to top</button><input class=sidebar-toggle id=pst-primary-sidebar-checkbox type=checkbox><label class="overlay overlay-primary"for=pst-primary-sidebar-checkbox></label><input class=sidebar-toggle id=pst-secondary-sidebar-checkbox type=checkbox><label class="overlay overlay-secondary"for=pst-secondary-sidebar-checkbox></label><div class=search-button__wrapper><div class=search-button__overlay></div><div class=search-button__search-container><form class="bd-search d-flex align-items-center"action=../../search.html><i class="fa-solid fa-magnifying-glass"></i><input aria-label=Search... autocapitalize=off autocomplete=off autocorrect=off class=form-control id=search-input name=q placeholder=Search... spellcheck=false type=search><span class=search-button__kbd-shortcut><kbd class=kbd-shortcut__modifier>Ctrl</kbd>+<kbd>K</kbd></span></form></div></div><div class="pst-async-banner-revealer d-none"><aside aria-label="Version warning"class="d-none d-print-none"id=bd-header-version-warning></aside></div><header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none"></header><div class=bd-container><div class="bd-container__inner bd-page-width"><div class="bd-sidebar-primary bd-sidebar"><div class="sidebar-header-items sidebar-primary__section"></div><div class="sidebar-primary-items__start sidebar-primary__section"><div class=sidebar-primary-item><a class="navbar-brand logo"href=../../index.html> <img alt="DeePTB  documentation - Home"class="logo__image only-light"src=../../_static/deeptb-logo.svg> <script>document.write(`<img src="../../_static/deeptb-logo.svg" class="logo__image only-dark" alt="DeePTB  documentation - Home"/>`)</script> </a></div><div class=sidebar-primary-item><script>document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `)</script></div><div class=sidebar-primary-item><nav class="bd-links bd-docs-nav"aria-label=Main><div class="bd-toc-item navbar-nav active"><p aria-level=2 class=caption role=heading><span class=caption-text>Quick Start</span></p><ul class="nav bd-sidenav"><li class=toctree-l1><a class="reference internal"href=../../quick_start/easy_install.html>Installation Guide</a></li><li class=toctree-l1><a class="reference internal"href=../../quick_start/input.html>Brief Intro. to Inputs and Commands</a></li><li class="toctree-l1 has-children"><a class="reference internal"href=../../quick_start/hands_on/index.html>A quick Example</a><details><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul><li class=toctree-l2><a class="reference internal"href=../../quick_start/hands_on/tutorial1_base_sk.html>Tutorial 1: deeptb-sk baseline model</a></li><li class=toctree-l2><a class="reference internal"href=../../quick_start/hands_on/tutorial2_data.html>Tutorial 2: data preparation for deeptb-sk model</a></li><li class=toctree-l2><a class="reference internal"href=../../quick_start/hands_on/tutorial3_train_si.html>Tutorial 3: Training deeptb-sk model for Silicon</a></li><li class=toctree-l2><a class="reference internal"href=../../quick_start/hands_on/tutorial4_E3_si.html>Tutorial 4: Training deeptb-e3 model for Silicon</a></li></ul></details></li><li class=toctree-l1><a class="reference internal"href=../../quick_start/basic_api.html>Basic API</a></li></ul><p aria-level=2 class=caption role=heading><span class=caption-text>INPUT TAG</span></p><ul class="nav bd-sidenav"><li class="toctree-l1 has-children"><a class="reference internal"href=../../input_params/index.html>Full Input Parameters</a><details><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul><li class=toctree-l2><a class="reference internal"href=../../input_params/common_options.html>Common Options</a></li><li class=toctree-l2><a class="reference internal"href=../../input_params/train_options.html>Train Options</a></li><li class=toctree-l2><a class="reference internal"href=../../input_params/model_options.html>Model Options</a></li><li class=toctree-l2><a class="reference internal"href=../../input_params/data_options.html>Data Options</a></li><li class=toctree-l2><a class="reference internal"href=../../input_params/run_options.html>Run Options</a></li><li class=toctree-l2><a class="reference internal"href=../../input_params/set_info.html>Set Info</a></li></ul></details></li></ul><p aria-level=2 class=caption role=heading><span class=caption-text>Advanced</span></p><ul class="current nav bd-sidenav"><li class="toctree-l1 current active has-children"><a class="reference internal"href=index.html>DeePTB-SK Advanced</a><details open><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul class=current><li class="toctree-l2 current active"><a class="current reference internal"href=#>DFTB SK Files to DeePTB Model</a></li><li class=toctree-l2><a class="reference internal"href=dptb_env.html>Environment-dependent TB</a></li><li class=toctree-l2><a class="reference internal"href=nrl_tb.html>NRL-TB paramererization</a></li><li class=toctree-l2><a class="reference internal"href=soc.html>Spin-orbit coupling</a></li></ul></details></li><li class="toctree-l1 has-children"><a class="reference internal"href=../e3tb/index.html>DeePTB-E3 Advanced</a><details><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul><li class=toctree-l2><a class="reference internal"href=../e3tb/advanced_input.html>More on Input Parameters</a></li><li class=toctree-l2><a class="reference internal"href=../e3tb/data_preparation.html>Data Preparation</a></li><li class=toctree-l2><a class="reference internal"href=../e3tb/loss_analysis.html>Loss Analysis</a></li></ul></details></li><li class="toctree-l1 has-children"><a class="reference internal"href=../elec_properties/index.html>Electronic Properties and Outputs</a><details><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul><li class=toctree-l2><a class="reference internal"href=../elec_properties/band.html>Band structure</a></li></ul></details></li><li class="toctree-l1 has-children"><a class="reference internal"href=../interface/index.html>Interfaces to Other Softwares</a><details><summary><span class=toctree-toggle role=presentation><i class="fa-solid fa-chevron-down"></i></span></summary><ul><li class=toctree-l2><a class="reference internal"href=../interface/TBPLAS.html>TBPLAS</a></li><li class=toctree-l2><a class="reference internal"href=../interface/TBtrans.html>TBtrans</a></li></ul></details></li></ul><p aria-level=2 class=caption role=heading><span class=caption-text>Citing DeePTB</span></p><ul class="nav bd-sidenav"><li class=toctree-l1><a class="reference internal"href=../../CITATIONS.html>How to Cite</a></li></ul><p aria-level=2 class=caption role=heading><span class=caption-text>Developing Team</span></p><ul class="nav bd-sidenav"><li class=toctree-l1><a class="reference internal"href=../../DevelopingTeam.html>Development Team</a></li></ul><p aria-level=2 class=caption role=heading><span class=caption-text>Community</span></p><ul class="nav bd-sidenav"><li class=toctree-l1><a class="reference internal"href=../../community/contribution_guide.html>DeePTB Contribution Guide</a></li><li class=toctree-l1><a class="reference internal"href=../../CONTRIBUTING.html>Contributing to DeePTB</a></li></ul></div></nav></div></div><div class="sidebar-primary-items__end sidebar-primary__section"></div><div id=rtd-footer-container></div></div><main class=bd-main id=main-content role=main><div class=sbt-scroll-pixel-helper></div><div class=bd-content><div class=bd-article-container><div class="bd-header-article d-print-none"><div class="header-article-items header-article__inner"><div class=header-article-items__start><div class=header-article-item><button class="sidebar-toggle primary-toggle btn btn-sm"title="Toggle primary sidebar"data-bs-placement=bottom data-bs-toggle=tooltip><span class="fa-solid fa-bars"></span></button></div></div><div class=header-article-items__end><div class=header-article-item><div class=article-header-buttons><div class="dropdown dropdown-download-buttons"><button aria-label="Download this page"class="btn dropdown-toggle"aria-expanded=false data-bs-toggle=dropdown type=button><i class="fas fa-download"></i></button><ul class=dropdown-menu><li><a class="btn btn-sm btn-download-source-button dropdown-item"title="Download source file"data-bs-placement=left data-bs-toggle=tooltip href=../../_sources/advanced/sktb/dftb.md target=_blank> <span class=btn__icon-container> <i class="fas fa-file"></i> </span> <span class=btn__text-container>.md</span> </a></li><li><button class="btn btn-sm btn-download-pdf-button dropdown-item"title="Print to PDF"data-bs-placement=left data-bs-toggle=tooltip onclick=window.print()><span class=btn__icon-container> <i class="fas fa-file-pdf"></i> </span> <span class=btn__text-container>.pdf</span></button></li></ul></div><button class="btn btn-sm btn-fullscreen-button"title="Fullscreen mode"data-bs-placement=bottom data-bs-toggle=tooltip onclick=toggleFullScreen()><span class=btn__icon-container> <i class="fas fa-expand"></i> </span></button><script>document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`)</script><script>document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`)</script><button class="sidebar-toggle secondary-toggle btn btn-sm"title="Toggle secondary sidebar"data-bs-placement=bottom data-bs-toggle=tooltip><span class="fa-solid fa-list"></span></button></div></div></div></div></div><div class=onlyprint id=jb-print-docs-body><h1>DFTB SK Files to DeePTB Model</h1><div id=print-main-content><div id=jb-print-toc><div><h2>Contents</h2></div><nav aria-label=Page><ul class="visible nav section-nav flex-column"><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#example-train-hbn-model-with-dftb-sk-files>Example: train hBN model with DFTB SK files</a><ul class="nav section-nav flex-column"><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#step-1-download-dftb-sk-files>Step 1: Download DFTB SK Files</a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#step-2-load-dftb-skfiles-to-in-deeptb-to-plot-band-structure>Step 2: Load DFTB skfiles to in DeePTB to plot band structure:</a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#step-3-use-sk-params-from-dftb-skfiles-to-train-deeptb-nnsk-model>Step 3: Use SK params from DFTB skfiles to train DeePTB nnsk model</a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#step4-load-the-previous-trained-model-to-further-train-the-model-use-eigenvalues>Step4: load the previous trained model to further train the model use eigenvalues</a></li></ul></li></ul></nav></div></div></div><div id=searchbox></div><article class=bd-article><section class="tex2jax_ignore mathjax_ignore"id=dftb-sk-files-to-deeptb-model><h1>DFTB SK Files to DeePTB Model<a title="Link to this heading"class=headerlink href=#dftb-sk-files-to-deeptb-model>#</a></h1><p>This example demonstrates how to build a DeePTB model from DFTB SK files. The DFTB SK files are generated by the DFTB+ code.</p><section id=example-train-hbn-model-with-dftb-sk-files><h2>Example: train hBN model with DFTB SK files<a title="Link to this heading"class=headerlink href=#example-train-hbn-model-with-dftb-sk-files>#</a></h2><section id=step-1-download-dftb-sk-files><h3>Step 1: Download DFTB SK Files<a title="Link to this heading"class=headerlink href=#step-1-download-dftb-sk-files>#</a></h3><p>you can download the skfiles from the <a class="reference external"href=https://dftb.org/parameters/download>dftb.org</a> website. Here we provide the some sk files in the folder <code class="docutils literal notranslate"><span class=pre>examples/hBN_dftb/slakos</span></code>.</p><div class="highlight-bash notranslate"><div class=highlight><pre><span></span>examples/hBN_dftb/slakos
├──<span class=w> </span>B-B.skf
├──<span class=w> </span>B-N.skf
├──<span class=w> </span>C-C.skf
├──<span class=w> </span>C-H.skf
├──<span class=w> </span>H-C.skf
├──<span class=w> </span>H-H.skf
├──<span class=w> </span>N-B.skf
├──<span class=w> </span>N-N.skf
└──<span class=w> </span>Si-Si.skf
</pre></div></div></section><section id=step-2-load-dftb-skfiles-to-in-deeptb-to-plot-band-structure><h3>Step 2: Load DFTB skfiles to in DeePTB to plot band structure:<a title="Link to this heading"class=headerlink href=#step-2-load-dftb-skfiles-to-in-deeptb-to-plot-band-structure>#</a></h3><div class="highlight-bash notranslate"><div class=highlight><pre><span></span><span class=nb>cd</span><span class=w> </span>examples/hBN_dftb
</pre></div></div><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=kn>from</span><span class=w> </span><span class=nn>dptb.nn.dftbsk</span><span class=w> </span><span class=kn>import</span> <span class=n>DFTBSK</span>
<span class=kn>from</span><span class=w> </span><span class=nn>ase.io</span><span class=w> </span><span class=kn>import</span> <span class=n>read</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dptb.data</span><span class=w> </span><span class=kn>import</span> <span class=n>AtomicData</span><span class=p>,</span> <span class=n>AtomicDataDict</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dptb.utils.tools</span><span class=w> </span><span class=kn>import</span> <span class=n>j_loader</span>
<span class=kn>import</span><span class=w> </span><span class=nn>torch</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dptb.postprocess.bandstructure.band</span><span class=w> </span><span class=kn>import</span> <span class=n>Band</span>

<span class=n>skdata</span> <span class=o>=</span> <span class=s1>'./slakos'</span>
<span class=n>basis</span> <span class=o>=</span> <span class=p>{</span><span class=s1>'B'</span><span class=p>:[</span><span class=s1>'2s'</span><span class=p>,</span><span class=s1>'2p'</span><span class=p>],</span><span class=s2>"N"</span><span class=p>:[</span><span class=s2>"2s"</span><span class=p>,</span><span class=s2>"2p"</span><span class=p>]}</span>
<span class=n>model</span> <span class=o>=</span> <span class=n>DFTBSK</span><span class=p>(</span><span class=n>basis</span><span class=o>=</span><span class=n>basis</span><span class=p>,</span> <span class=n>skdata</span><span class=o>=</span><span class=n>skdata</span><span class=p>,</span><span class=n>overlap</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>


<span class=n>task_options</span><span class=o>=</span><span class=p>{</span>
        <span class=s2>"task"</span><span class=p>:</span> <span class=s2>"band"</span><span class=p>,</span>
        <span class=s2>"kline_type"</span><span class=p>:</span><span class=s2>"abacus"</span><span class=p>,</span>
        <span class=s2>"kpath"</span><span class=p>:[</span>
            <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
            <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
            <span class=p>[</span><span class=mf>0.3333333</span><span class=p>,</span> <span class=mf>0.3333333</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
            <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
        <span class=p>],</span>
        <span class=s2>"nel_atom"</span><span class=p>:{</span><span class=s2>"N"</span><span class=p>:</span><span class=mi>5</span><span class=p>,</span><span class=s2>"B"</span><span class=p>:</span><span class=mi>3</span><span class=p>},</span>
        <span class=s2>"klabels"</span><span class=p>:[</span><span class=s2>"G"</span><span class=p>,</span> <span class=s2>"M"</span><span class=p>,</span> <span class=s2>"K"</span><span class=p>,</span> <span class=s2>"G"</span><span class=p>],</span>
        <span class=s2>"E_fermi"</span><span class=p>:</span><span class=o>-</span><span class=mf>12.798759460449219</span><span class=p>,</span>
        <span class=s2>"emin"</span><span class=p>:</span><span class=o>-</span><span class=mi>25</span><span class=p>,</span>
        <span class=s2>"emax"</span><span class=p>:</span><span class=mi>15</span><span class=p>,</span>
        <span class=s2>"ref_band"</span><span class=p>:</span> <span class=s2>"./data/kpath.0/eigenvalues.npy"</span>
    <span class=p>}</span>

<span class=n>kpath_kwargs</span> <span class=o>=</span> <span class=n>task_options</span>
<span class=n>stru_data</span> <span class=o>=</span> <span class=s2>"./data/struct.vasp"</span>

<span class=n>AtomicData_options</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"r_max"</span><span class=p>:</span> <span class=mf>5.0</span><span class=p>,</span> <span class=s2>"oer_max"</span><span class=p>:</span><span class=mf>1.6</span><span class=p>,</span> <span class=s2>"pbc"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
<span class=n>structase</span> <span class=o>=</span> <span class=n>read</span><span class=p>(</span><span class=n>stru_data</span><span class=p>)</span>

<span class=n>bcal</span> <span class=o>=</span> <span class=n>Band</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>,</span> 
            <span class=n>use_gui</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> 
            <span class=n>results_path</span><span class=o>=</span><span class=s2>"./"</span><span class=p>,</span> 
            <span class=n>device</span><span class=o>=</span><span class=n>model</span><span class=o>.</span><span class=n>device</span><span class=p>)</span>
<span class=n>eigenstatus</span> <span class=o>=</span> <span class=n>bcal</span><span class=o>.</span><span class=n>get_bands</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>stru_data</span><span class=p>,</span> 
               <span class=n>kpath_kwargs</span><span class=o>=</span><span class=n>kpath_kwargs</span><span class=p>,</span> 
               <span class=n>AtomicData_options</span><span class=o>=</span><span class=n>AtomicData_options</span><span class=p>)</span>
<span class=n>bcal</span><span class=o>.</span><span class=n>band_plot</span><span class=p>(</span><span class=n>ref_band</span> <span class=o>=</span> <span class=n>kpath_kwargs</span><span class=p>[</span><span class=s2>"ref_band"</span><span class=p>],</span>
               <span class=n>E_fermi</span> <span class=o>=</span> <span class=o>-</span><span class=mi>2</span><span class=p>,</span>
               <span class=n>emin</span> <span class=o>=</span> <span class=o>-</span><span class=mi>25</span><span class=p>,</span>
               <span class=n>emax</span> <span class=o>=</span> <span class=mi>15</span><span class=p>)</span>
</pre></div></div><a class="reference internal image-reference"href=https://raw.githubusercontent.com/deepmodeling/DeePTB/main/docs/img/hbn_dftb.png><img alt=示例图片 src=https://raw.githubusercontent.com/deepmodeling/DeePTB/main/docs/img/hbn_dftb.png style=width:500px> </a></section><section id=step-3-use-sk-params-from-dftb-skfiles-to-train-deeptb-nnsk-model><h3>Step 3: Use SK params from DFTB skfiles to train DeePTB nnsk model<a title="Link to this heading"class=headerlink href=#step-3-use-sk-params-from-dftb-skfiles-to-train-deeptb-nnsk-model>#</a></h3><p>use the input.json in the following:</p><div class="highlight-json notranslate"><div class=highlight><pre><span></span><span class=p>{</span>
<span class=w>    </span><span class=nt>"common_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"basis"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=nt>"B"</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>"2s"</span><span class=p>,</span><span class=w> </span><span class=s2>"2p"</span><span class=p>],</span>
<span class=w>                </span><span class=nt>"N"</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>"2s"</span><span class=p>,</span><span class=w> </span><span class=s2>"2p"</span><span class=p>]</span>
<span class=w>            </span><span class=p>},</span>
<span class=w>            </span><span class=nt>"device"</span><span class=p>:</span><span class=w> </span><span class=s2>"cpu"</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"dtype"</span><span class=p>:</span><span class=w> </span><span class=s2>"float32"</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"overlap"</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"seed"</span><span class=p>:</span><span class=w> </span><span class=mi>42</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>"train_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>"num_epoch"</span><span class=p>:</span><span class=w> </span><span class=mi>500</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"batch_size"</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"optimizer"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"lr"</span><span class=p>:</span><span class=w> </span><span class=mf>0.01</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"type"</span><span class=p>:</span><span class=w> </span><span class=s2>"Adam"</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>"lr_scheduler"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"type"</span><span class=p>:</span><span class=w> </span><span class=s2>"exp"</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"gamma"</span><span class=p>:</span><span class=w> </span><span class=mf>0.999</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>"loss_options"</span><span class=p>:{</span>
<span class=w>            </span><span class=nt>"train"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=nt>"method"</span><span class=p>:</span><span class=w> </span><span class=s2>"skints"</span><span class=p>,</span><span class=w> </span><span class=nt>"skdata"</span><span class=p>:</span><span class=s2>"./slakos"</span><span class=p>}</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>"save_freq"</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"validation_freq"</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"display_freq"</span><span class=p>:</span><span class=w> </span><span class=mi>10</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>"model_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>"nnsk"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"onsite"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=nt>"method"</span><span class=p>:</span><span class=w> </span><span class=s2>"uniform"</span><span class=p>},</span>
<span class=w>            </span><span class=nt>"hopping"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=nt>"method"</span><span class=p>:</span><span class=w> </span><span class=s2>"powerlaw"</span><span class=p>,</span><span class=w> </span><span class=nt>"rs"</span><span class=p>:</span><span class=mf>4.5</span><span class=p>,</span><span class=w> </span><span class=nt>"w"</span><span class=p>:</span><span class=w> </span><span class=mf>0.2</span><span class=p>},</span>
<span class=w>            </span><span class=nt>"soc"</span><span class=p>:{},</span>
<span class=w>            </span><span class=nt>"freeze"</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"push"</span><span class=p>:</span><span class=kc>false</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>"data_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>"train"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"root"</span><span class=p>:</span><span class=w> </span><span class=s2>"./data/"</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"prefix"</span><span class=p>:</span><span class=w> </span><span class=s2>"kpath"</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"get_eigenvalues"</span><span class=p>:</span><span class=w> </span><span class=kc>false</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</pre></div></div><p>And then run the following command:</p><div class="highlight-bash notranslate"><div class=highlight><pre><span></span>dptb<span class=w> </span>train<span class=w> </span>input_nnsk_skints.json<span class=w> </span>-o<span class=w> </span>./nnskint<span class=w> </span>
</pre></div></div><p>Then you can get the model in nnskint/checkpoint;</p><p><strong>note</strong> The overlap in common_options is set to false. The overlap in DFTB sk files will not be used.</p><p>We can see the band structure using the following code:</p><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=kn>from</span><span class=w> </span><span class=nn>dptb.nn.build</span><span class=w> </span><span class=kn>import</span> <span class=n>build_model</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dptb.utils.tools</span><span class=w> </span><span class=kn>import</span> <span class=n>j_loader</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dptb.postprocess.bandstructure.band</span><span class=w> </span><span class=kn>import</span> <span class=n>Band</span>


<span class=n>model</span> <span class=o>=</span> <span class=n>build_model</span><span class=p>(</span><span class=n>checkpoint</span><span class=o>=</span><span class=s2>"./nnskint/checkpoint/nnsk.best.pth"</span><span class=p>)</span>

<span class=n>task_options</span><span class=o>=</span><span class=p>{</span>
        <span class=s2>"task"</span><span class=p>:</span> <span class=s2>"band"</span><span class=p>,</span>
        <span class=s2>"kline_type"</span><span class=p>:</span><span class=s2>"abacus"</span><span class=p>,</span>
        <span class=s2>"kpath"</span><span class=p>:[</span>
            <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
            <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
            <span class=p>[</span><span class=mf>0.3333333</span><span class=p>,</span> <span class=mf>0.3333333</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
            <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
        <span class=p>],</span>
        <span class=s2>"nel_atom"</span><span class=p>:{</span><span class=s2>"N"</span><span class=p>:</span><span class=mi>5</span><span class=p>,</span><span class=s2>"B"</span><span class=p>:</span><span class=mi>3</span><span class=p>},</span>
        <span class=s2>"klabels"</span><span class=p>:[</span><span class=s2>"G"</span><span class=p>,</span> <span class=s2>"M"</span><span class=p>,</span> <span class=s2>"K"</span><span class=p>,</span> <span class=s2>"G"</span><span class=p>],</span>
        <span class=s2>"E_fermi"</span><span class=p>:</span><span class=o>-</span><span class=mf>12.798759460449219</span><span class=p>,</span>
        <span class=s2>"emin"</span><span class=p>:</span><span class=o>-</span><span class=mi>25</span><span class=p>,</span>
        <span class=s2>"emax"</span><span class=p>:</span><span class=mi>15</span><span class=p>,</span>
        <span class=s2>"ref_band"</span><span class=p>:</span> <span class=s2>"./data/kpath.0/eigenvalues.npy"</span>
    <span class=p>}</span>

<span class=n>kpath_kwargs</span> <span class=o>=</span> <span class=n>task_options</span>

<span class=n>stru_data</span> <span class=o>=</span> <span class=s2>"./data/struct.vasp"</span>
<span class=n>AtomicData_options</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"r_max"</span><span class=p>:</span> <span class=mf>5.0</span><span class=p>,</span><span class=s2>"er_max"</span><span class=p>:</span> <span class=mf>3.5</span><span class=p>,</span> <span class=s2>"oer_max"</span><span class=p>:</span><span class=mf>1.6</span><span class=p>,</span> <span class=s2>"pbc"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>

<span class=n>bcal</span> <span class=o>=</span> <span class=n>Band</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>,</span> 
            <span class=n>use_gui</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> 
            <span class=n>results_path</span><span class=o>=</span><span class=s1>'./'</span><span class=p>,</span> 
            <span class=n>device</span><span class=o>=</span><span class=n>model</span><span class=o>.</span><span class=n>device</span><span class=p>)</span>
<span class=n>eigenstatus</span> <span class=o>=</span> <span class=n>bcal</span><span class=o>.</span><span class=n>get_bands</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>stru_data</span><span class=p>,</span> 
               <span class=n>kpath_kwargs</span><span class=o>=</span><span class=n>kpath_kwargs</span><span class=p>,</span> 
               <span class=n>AtomicData_options</span><span class=o>=</span><span class=n>AtomicData_options</span><span class=p>)</span>
<span class=n>bcal</span><span class=o>.</span><span class=n>band_plot</span><span class=p>(</span><span class=n>ref_band</span> <span class=o>=</span> <span class=n>kpath_kwargs</span><span class=p>[</span><span class=s2>"ref_band"</span><span class=p>],</span>
               <span class=n>E_fermi</span> <span class=o>=</span> <span class=o>-</span><span class=mi>5</span><span class=p>,</span>
               <span class=n>emin</span> <span class=o>=</span> <span class=o>-</span><span class=mi>22</span><span class=p>,</span>
               <span class=n>emax</span> <span class=o>=</span> <span class=mi>10</span><span class=p>)</span>
</pre></div></div><a class="reference internal image-reference"href=https://raw.githubusercontent.com/deepmodeling/DeePTB/main/docs/img/hbn_nnsk_dftb_no_s.png><img alt=示例图片 src=https://raw.githubusercontent.com/deepmodeling/DeePTB/main/docs/img/hbn_nnsk_dftb_no_s.png style=width:500px> </a><p><strong>NOTE:</strong> By setting the “overlap”: true, and retrain the model, deeptb can get the overlap back.</p><div class="highlight-bash notranslate"><div class=highlight><pre><span></span>dptb<span class=w> </span>train<span class=w> </span>input_nnsk_skints.json<span class=w> </span>-o<span class=w> </span>./nnskint_overlap<span class=w> </span>
</pre></div></div><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=kn>from</span><span class=w> </span><span class=nn>dptb.nn.build</span><span class=w> </span><span class=kn>import</span> <span class=n>build_model</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dptb.utils.tools</span><span class=w> </span><span class=kn>import</span> <span class=n>j_loader</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dptb.postprocess.bandstructure.band</span><span class=w> </span><span class=kn>import</span> <span class=n>Band</span>


<span class=n>model</span> <span class=o>=</span> <span class=n>build_model</span><span class=p>(</span><span class=n>checkpoint</span><span class=o>=</span><span class=s2>"./nnskint_overlap/checkpoint/nnsk.best.pth"</span><span class=p>)</span>

<span class=n>task_options</span><span class=o>=</span><span class=p>{</span>
        <span class=s2>"task"</span><span class=p>:</span> <span class=s2>"band"</span><span class=p>,</span>
        <span class=s2>"kline_type"</span><span class=p>:</span><span class=s2>"abacus"</span><span class=p>,</span>
        <span class=s2>"kpath"</span><span class=p>:[</span>
            <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
            <span class=p>[</span><span class=mf>0.5</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
            <span class=p>[</span><span class=mf>0.3333333</span><span class=p>,</span> <span class=mf>0.3333333</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>50</span><span class=p>],</span>
            <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span>
        <span class=p>],</span>
        <span class=s2>"nel_atom"</span><span class=p>:{</span><span class=s2>"N"</span><span class=p>:</span><span class=mi>5</span><span class=p>,</span><span class=s2>"B"</span><span class=p>:</span><span class=mi>3</span><span class=p>},</span>
        <span class=s2>"klabels"</span><span class=p>:[</span><span class=s2>"G"</span><span class=p>,</span> <span class=s2>"M"</span><span class=p>,</span> <span class=s2>"K"</span><span class=p>,</span> <span class=s2>"G"</span><span class=p>],</span>
        <span class=s2>"E_fermi"</span><span class=p>:</span><span class=o>-</span><span class=mf>12.798759460449219</span><span class=p>,</span>
        <span class=s2>"emin"</span><span class=p>:</span><span class=o>-</span><span class=mi>25</span><span class=p>,</span>
        <span class=s2>"emax"</span><span class=p>:</span><span class=mi>15</span><span class=p>,</span>
        <span class=s2>"ref_band"</span><span class=p>:</span> <span class=s2>"./data/kpath.0/eigenvalues.npy"</span>
    <span class=p>}</span>

<span class=n>kpath_kwargs</span> <span class=o>=</span> <span class=n>task_options</span>

<span class=n>stru_data</span> <span class=o>=</span> <span class=s2>"./data/struct.vasp"</span>
<span class=n>AtomicData_options</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"r_max"</span><span class=p>:</span> <span class=mf>5.0</span><span class=p>,</span><span class=s2>"er_max"</span><span class=p>:</span> <span class=mf>3.5</span><span class=p>,</span> <span class=s2>"oer_max"</span><span class=p>:</span><span class=mf>1.6</span><span class=p>,</span> <span class=s2>"pbc"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>

<span class=n>bcal</span> <span class=o>=</span> <span class=n>Band</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>,</span> 
            <span class=n>use_gui</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> 
            <span class=n>results_path</span><span class=o>=</span><span class=s1>'./'</span><span class=p>,</span> 
            <span class=n>device</span><span class=o>=</span><span class=n>model</span><span class=o>.</span><span class=n>device</span><span class=p>)</span>
<span class=n>eigenstatus</span> <span class=o>=</span> <span class=n>bcal</span><span class=o>.</span><span class=n>get_bands</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>stru_data</span><span class=p>,</span> 
               <span class=n>kpath_kwargs</span><span class=o>=</span><span class=n>kpath_kwargs</span><span class=p>,</span> 
               <span class=n>AtomicData_options</span><span class=o>=</span><span class=n>AtomicData_options</span><span class=p>)</span>
<span class=n>bcal</span><span class=o>.</span><span class=n>band_plot</span><span class=p>(</span><span class=n>ref_band</span> <span class=o>=</span> <span class=n>kpath_kwargs</span><span class=p>[</span><span class=s2>"ref_band"</span><span class=p>],</span>
               <span class=n>E_fermi</span> <span class=o>=</span> <span class=o>-</span><span class=mi>5</span><span class=p>,</span>
               <span class=n>emin</span> <span class=o>=</span> <span class=o>-</span><span class=mi>22</span><span class=p>,</span>
               <span class=n>emax</span> <span class=o>=</span> <span class=mi>10</span><span class=p>)</span>
</pre></div></div><a class="reference internal image-reference"href=https://raw.githubusercontent.com/deepmodeling/DeePTB/main/docs/img/hbn_nnsk_dftb.png><img alt=示例图片 src=https://raw.githubusercontent.com/deepmodeling/DeePTB/main/docs/img/hbn_nnsk_dftb.png style=width:500px> </a></section><section id=step4-load-the-previous-trained-model-to-further-train-the-model-use-eigenvalues><h3>Step4: load the previous trained model to further train the model use eigenvalues<a title="Link to this heading"class=headerlink href=#step4-load-the-previous-trained-model-to-further-train-the-model-use-eigenvalues>#</a></h3><p>The input json looks like:</p><div class="highlight-json notranslate"><div class=highlight><pre><span></span><span class=p>{</span>
<span class=w>    </span><span class=nt>"common_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"basis"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=nt>"B"</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>"2s"</span><span class=p>,</span><span class=w> </span><span class=s2>"2p"</span><span class=p>],</span>
<span class=w>                </span><span class=nt>"N"</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>"2s"</span><span class=p>,</span><span class=w> </span><span class=s2>"2p"</span><span class=p>]</span>
<span class=w>            </span><span class=p>},</span>
<span class=w>            </span><span class=nt>"device"</span><span class=p>:</span><span class=w> </span><span class=s2>"cpu"</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"dtype"</span><span class=p>:</span><span class=w> </span><span class=s2>"float32"</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"overlap"</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"seed"</span><span class=p>:</span><span class=w> </span><span class=mi>42</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>"train_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>"num_epoch"</span><span class=p>:</span><span class=w> </span><span class=mi>500</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"batch_size"</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"optimizer"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"lr"</span><span class=p>:</span><span class=w> </span><span class=mf>0.01</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"type"</span><span class=p>:</span><span class=w> </span><span class=s2>"Adam"</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>"lr_scheduler"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"type"</span><span class=p>:</span><span class=w> </span><span class=s2>"exp"</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"gamma"</span><span class=p>:</span><span class=w> </span><span class=mf>0.999</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>"loss_options"</span><span class=p>:{</span>
<span class=w>            </span><span class=nt>"train"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=nt>"method"</span><span class=p>:</span><span class=w> </span><span class=s2>"eigvals"</span><span class=p>}</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=nt>"save_freq"</span><span class=p>:</span><span class=w> </span><span class=mi>50</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"validation_freq"</span><span class=p>:</span><span class=w> </span><span class=mi>10</span><span class=p>,</span>
<span class=w>        </span><span class=nt>"display_freq"</span><span class=p>:</span><span class=w> </span><span class=mi>10</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>"model_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>"nnsk"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"onsite"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=nt>"method"</span><span class=p>:</span><span class=w> </span><span class=s2>"uniform"</span><span class=p>},</span>
<span class=w>            </span><span class=nt>"hopping"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=nt>"method"</span><span class=p>:</span><span class=w> </span><span class=s2>"powerlaw"</span><span class=p>,</span><span class=w> </span><span class=nt>"rs"</span><span class=p>:</span><span class=mf>4.5</span><span class=p>,</span><span class=w> </span><span class=nt>"w"</span><span class=p>:</span><span class=w> </span><span class=mf>0.2</span><span class=p>},</span>
<span class=w>            </span><span class=nt>"soc"</span><span class=p>:{},</span>
<span class=w>            </span><span class=nt>"freeze"</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"push"</span><span class=p>:</span><span class=kc>false</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nt>"data_options"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nt>"train"</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nt>"root"</span><span class=p>:</span><span class=w> </span><span class=s2>"./data/"</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"prefix"</span><span class=p>:</span><span class=w> </span><span class=s2>"kpath"</span><span class=p>,</span>
<span class=w>            </span><span class=nt>"get_eigenvalues"</span><span class=p>:</span><span class=w> </span><span class=kc>true</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</pre></div></div><p><strong>None</strong>: we want have the orthogonal TB model. The overlap in common_options is set to false. The overlap in DFTB sk files will not be used.</p><div class="highlight-bash notranslate"><div class=highlight><pre><span></span>dptb<span class=w> </span>train<span class=w> </span>input_nnsk_eigvals.json<span class=w> </span>-i<span class=w> </span>nnskint/checkpoint/nnsk.best.pth<span class=w> </span>-o<span class=w> </span>./nnsk_eigvals
</pre></div></div><p>Show the bands:</p><div class="highlight-python notranslate"><div class=highlight><pre><span></span>
<span class=kn>from</span><span class=w> </span><span class=nn>dptb.nn.build</span><span class=w> </span><span class=kn>import</span> <span class=n>build_model</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dptb.utils.tools</span><span class=w> </span><span class=kn>import</span> <span class=n>j_loader</span>
<span class=kn>from</span><span class=w> </span><span class=nn>dptb.postprocess.bandstructure.band</span><span class=w> </span><span class=kn>import</span> <span class=n>Band</span>


<span class=n>model</span> <span class=o>=</span> <span class=n>build_model</span><span class=p>(</span><span class=n>checkpoint</span><span class=o>=</span><span class=s2>"./nnsk_eigvals/checkpoint/nnsk.ep500.pth"</span><span class=p>)</span>
<span class=n>jdata</span> <span class=o>=</span> <span class=n>j_loader</span><span class=p>(</span><span class=s2>"./run/band.json"</span><span class=p>)</span>
<span class=n>results_path</span> <span class=o>=</span> <span class=s2>"./band_plot"</span>
<span class=n>kpath_kwargs</span> <span class=o>=</span> <span class=n>jdata</span><span class=p>[</span><span class=s2>"task_options"</span><span class=p>]</span>
<span class=n>stru_data</span> <span class=o>=</span> <span class=s2>"./data/struct.vasp"</span>
<span class=n>AtomicData_options</span> <span class=o>=</span> <span class=p>{</span><span class=s2>"r_max"</span><span class=p>:</span> <span class=mf>5.0</span><span class=p>,</span><span class=s2>"er_max"</span><span class=p>:</span> <span class=mf>3.5</span><span class=p>,</span> <span class=s2>"oer_max"</span><span class=p>:</span><span class=mf>1.6</span><span class=p>,</span> <span class=s2>"pbc"</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>

<span class=n>bcal</span> <span class=o>=</span> <span class=n>Band</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=n>model</span><span class=p>,</span> 
            <span class=n>use_gui</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> 
            <span class=n>results_path</span><span class=o>=</span><span class=s1>'./'</span><span class=p>,</span> 
            <span class=n>device</span><span class=o>=</span><span class=n>model</span><span class=o>.</span><span class=n>device</span><span class=p>)</span>
<span class=n>eigenstatus</span> <span class=o>=</span> <span class=n>bcal</span><span class=o>.</span><span class=n>get_bands</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>stru_data</span><span class=p>,</span> 
               <span class=n>kpath_kwargs</span><span class=o>=</span><span class=n>kpath_kwargs</span><span class=p>,</span> 
               <span class=n>AtomicData_options</span><span class=o>=</span><span class=n>AtomicData_options</span><span class=p>)</span>
<span class=n>bcal</span><span class=o>.</span><span class=n>band_plot</span><span class=p>(</span><span class=n>ref_band</span> <span class=o>=</span> <span class=n>kpath_kwargs</span><span class=p>[</span><span class=s2>"ref_band"</span><span class=p>],</span>
               <span class=n>E_fermi</span> <span class=o>=</span> <span class=o>-</span><span class=mi>5</span><span class=p>,</span>
               <span class=n>emin</span> <span class=o>=</span> <span class=o>-</span><span class=mi>22</span><span class=p>,</span>
               <span class=n>emax</span> <span class=o>=</span> <span class=mi>10</span><span class=p>)</span>
</pre></div></div><a class="reference internal image-reference"href=https://raw.githubusercontent.com/deepmodeling/DeePTB/main/docs/img/hbn_nnsk_eigs.png><img alt=示例图片 src=https://raw.githubusercontent.com/deepmodeling/DeePTB/main/docs/img/hbn_nnsk_eigs.png style=width:500px> </a></section></section></section></article><footer class="prev-next-footer d-print-none"><div class=prev-next-area><a title="previous page"class=left-prev href=index.html> <i class="fa-solid fa-angle-left"></i> <div class=prev-next-info><p class=prev-next-subtitle>previous</p><p class=prev-next-title>DeePTB-SK Advanced</p></div> </a><a title="next page"class=right-next href=dptb_env.html> <div class=prev-next-info><p class=prev-next-subtitle>next</p><p class=prev-next-title>Environment-dependent TB</p></div> <i class="fa-solid fa-angle-right"></i> </a></div></footer></div><div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner"><div class=sidebar-secondary-item><div class="page-toc tocsection onthispage"><i class="fa-solid fa-list"></i> Contents</div><nav class="bd-toc-nav page-toc"><ul class="visible nav section-nav flex-column"><li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"href=#example-train-hbn-model-with-dftb-sk-files>Example: train hBN model with DFTB SK files</a><ul class="nav section-nav flex-column"><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#step-1-download-dftb-sk-files>Step 1: Download DFTB SK Files</a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#step-2-load-dftb-skfiles-to-in-deeptb-to-plot-band-structure>Step 2: Load DFTB skfiles to in DeePTB to plot band structure:</a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#step-3-use-sk-params-from-dftb-skfiles-to-train-deeptb-nnsk-model>Step 3: Use SK params from DFTB skfiles to train DeePTB nnsk model</a></li><li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link"href=#step4-load-the-previous-trained-model-to-further-train-the-model-use-eigenvalues>Step4: load the previous trained model to further train the model use eigenvalues</a></li></ul></li></ul></nav></div></div></div></div><footer class=bd-footer-content><div class="bd-footer-content__inner container"><div class=footer-item><p class=component-author>By DeePTB</p></div><div class=footer-item><p class=copyright>© Copyright 2023, DeePTB. <br></p></div><div class=footer-item></div><div class=footer-item><div class=extra_footer><p><a href=https://beian.miit.gov.cn target=_blank>京ICP备20010051号-8</a></p></div></div></div></footer></main></div></div><script src=../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b></script><script src=../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b></script><footer class=bd-footer></footer></body></html>